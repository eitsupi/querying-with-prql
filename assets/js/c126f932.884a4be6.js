"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[908],{5906:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>g,contentTitle:()=>r,default:()=>y,frontMatter:()=>s,metadata:()=>h,quartoRawHtml:()=>o,toc:()=>c});var l=n(5893),d=n(1151),a=n(4866),i=n(5162);const s={title:"Timeseries",description:"Handling timeseries data.",engine:"knitr",knitr:{opts_chunk:{connection:"con","engine-opts":{target:"sql.duckdb",use_glue:!0}}},execute:{cache:!0},sidebar_position:5},r=void 0,h={id:"timeseries",title:"Timeseries",description:"Handling timeseries data.",source:"@site/docs/timeseries.mdx",sourceDirName:".",slug:"/timeseries",permalink:"/querying-with-prql/timeseries",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"Timeseries",description:"Handling timeseries data.",engine:"knitr",knitr:{opts_chunk:{connection:"con","engine-opts":{target:"sql.duckdb",use_glue:!0}}},execute:{cache:!0},sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Reshaping and Tidy Data",permalink:"/querying-with-prql/tidy"}},g={},o=['\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-01</td>\n<td style="text-align: right;">28923.63</td>\n<td style="text-align: right;">29600.00</td>\n<td style="text-align: right;">28624.57</td>\n<td style="text-align: right;">29331.69</td>\n<td style="text-align: right;">54182.93</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-02</td>\n<td style="text-align: right;">29331.70</td>\n<td style="text-align: right;">33300.00</td>\n<td style="text-align: right;">28946.53</td>\n<td style="text-align: right;">32178.33</td>\n<td style="text-align: right;">129993.87</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-03</td>\n<td style="text-align: right;">32176.45</td>\n<td style="text-align: right;">34778.11</td>\n<td style="text-align: right;">31962.99</td>\n<td style="text-align: right;">33000.05</td>\n<td style="text-align: right;">120957.57</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-04</td>\n<td style="text-align: right;">33000.05</td>\n<td style="text-align: right;">33600.00</td>\n<td style="text-align: right;">28130.00</td>\n<td style="text-align: right;">31988.71</td>\n<td style="text-align: right;">140899.89</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-05</td>\n<td style="text-align: right;">31989.75</td>\n<td style="text-align: right;">34360.00</td>\n<td style="text-align: right;">29900.00</td>\n<td style="text-align: right;">33949.53</td>\n<td style="text-align: right;">116050.00</td>\n</tr>\n</tbody>\n</table>\n','\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-01</td>\n<td style="text-align: right;">28923.63</td>\n<td style="text-align: right;">29600.00</td>\n<td style="text-align: right;">28624.57</td>\n<td style="text-align: right;">29331.69</td>\n<td style="text-align: right;">54182.93</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-02</td>\n<td style="text-align: right;">29331.70</td>\n<td style="text-align: right;">33300.00</td>\n<td style="text-align: right;">28946.53</td>\n<td style="text-align: right;">32178.33</td>\n<td style="text-align: right;">129993.87</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-03</td>\n<td style="text-align: right;">32176.45</td>\n<td style="text-align: right;">34778.11</td>\n<td style="text-align: right;">31962.99</td>\n<td style="text-align: right;">33000.05</td>\n<td style="text-align: right;">120957.57</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-04</td>\n<td style="text-align: right;">33000.05</td>\n<td style="text-align: right;">33600.00</td>\n<td style="text-align: right;">28130.00</td>\n<td style="text-align: right;">31988.71</td>\n<td style="text-align: right;">140899.89</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-05</td>\n<td style="text-align: right;">31989.75</td>\n<td style="text-align: right;">34360.00</td>\n<td style="text-align: right;">29900.00</td>\n<td style="text-align: right;">33949.53</td>\n<td style="text-align: right;">116050.00</td>\n</tr>\n</tbody>\n</table>\n',"<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 6)</small>",'\n<table class="dataframe" data-quarto-postprocess="true" data-border="1">\n<thead>\n<tr class="header">\n<th data-quarto-table-cell-role="th">time</th>\n<th data-quarto-table-cell-role="th">open</th>\n<th data-quarto-table-cell-role="th">high</th>\n<th data-quarto-table-cell-role="th">low</th>\n<th data-quarto-table-cell-role="th">close</th>\n<th data-quarto-table-cell-role="th">volume</th>\n</tr>\n<tr class="odd">\n<th>date</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td>2021-01-01</td>\n<td>28923.63</td>\n<td>29600.0</td>\n<td>28624.57</td>\n<td>29331.69</td>\n<td>54182.925011</td>\n</tr>\n<tr class="even">\n<td>2021-01-02</td>\n<td>29331.7</td>\n<td>33300.0</td>\n<td>28946.53</td>\n<td>32178.33</td>\n<td>129993.873362</td>\n</tr>\n<tr class="odd">\n<td>2021-01-03</td>\n<td>32176.45</td>\n<td>34778.11</td>\n<td>31962.99</td>\n<td>33000.05</td>\n<td>120957.56675</td>\n</tr>\n<tr class="even">\n<td>2021-01-04</td>\n<td>33000.05</td>\n<td>33600.0</td>\n<td>28130.0</td>\n<td>31988.71</td>\n<td>140899.88569</td>\n</tr>\n<tr class="odd">\n<td>2021-01-05</td>\n<td>31989.75</td>\n<td>34360.0</td>\n<td>29900.0</td>\n<td>33949.53</td>\n<td>116049.997038</td>\n</tr>\n</tbody>\n</table>\n',"</div>",'\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-02-01</td>\n<td style="text-align: right;">33092.97</td>\n<td style="text-align: right;">34717.27</td>\n<td style="text-align: right;">32296.16</td>\n<td style="text-align: right;">33526.37</td>\n<td style="text-align: right;">82718.28</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-02-02</td>\n<td style="text-align: right;">33517.09</td>\n<td style="text-align: right;">35984.33</td>\n<td style="text-align: right;">33418.00</td>\n<td style="text-align: right;">35466.24</td>\n<td style="text-align: right;">78056.66</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-02-03</td>\n<td style="text-align: right;">35472.71</td>\n<td style="text-align: right;">37662.63</td>\n<td style="text-align: right;">35362.38</td>\n<td style="text-align: right;">37618.87</td>\n<td style="text-align: right;">80784.33</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-02-04</td>\n<td style="text-align: right;">37620.26</td>\n<td style="text-align: right;">38708.27</td>\n<td style="text-align: right;">36161.95</td>\n<td style="text-align: right;">36936.66</td>\n<td style="text-align: right;">92080.74</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-02-05</td>\n<td style="text-align: right;">36936.65</td>\n<td style="text-align: right;">38310.12</td>\n<td style="text-align: right;">36570.00</td>\n<td style="text-align: right;">38290.24</td>\n<td style="text-align: right;">66681.33</td>\n</tr>\n</tbody>\n</table>\n','\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-02-01</td>\n<td style="text-align: right;">33092.97</td>\n<td style="text-align: right;">34717.27</td>\n<td style="text-align: right;">32296.16</td>\n<td style="text-align: right;">33526.37</td>\n<td style="text-align: right;">82718.28</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-02-02</td>\n<td style="text-align: right;">33517.09</td>\n<td style="text-align: right;">35984.33</td>\n<td style="text-align: right;">33418.00</td>\n<td style="text-align: right;">35466.24</td>\n<td style="text-align: right;">78056.66</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-02-03</td>\n<td style="text-align: right;">35472.71</td>\n<td style="text-align: right;">37662.63</td>\n<td style="text-align: right;">35362.38</td>\n<td style="text-align: right;">37618.87</td>\n<td style="text-align: right;">80784.33</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-02-04</td>\n<td style="text-align: right;">37620.26</td>\n<td style="text-align: right;">38708.27</td>\n<td style="text-align: right;">36161.95</td>\n<td style="text-align: right;">36936.66</td>\n<td style="text-align: right;">92080.74</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-02-05</td>\n<td style="text-align: right;">36936.65</td>\n<td style="text-align: right;">38310.12</td>\n<td style="text-align: right;">36570.00</td>\n<td style="text-align: right;">38290.24</td>\n<td style="text-align: right;">66681.33</td>\n</tr>\n</tbody>\n</table>\n','\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-02-01</td>\n<td style="text-align: right;">33092.97</td>\n<td style="text-align: right;">34717.27</td>\n<td style="text-align: right;">32296.16</td>\n<td style="text-align: right;">33526.37</td>\n<td style="text-align: right;">82718.28</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-02-02</td>\n<td style="text-align: right;">33517.09</td>\n<td style="text-align: right;">35984.33</td>\n<td style="text-align: right;">33418.00</td>\n<td style="text-align: right;">35466.24</td>\n<td style="text-align: right;">78056.66</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-02-03</td>\n<td style="text-align: right;">35472.71</td>\n<td style="text-align: right;">37662.63</td>\n<td style="text-align: right;">35362.38</td>\n<td style="text-align: right;">37618.87</td>\n<td style="text-align: right;">80784.33</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-02-04</td>\n<td style="text-align: right;">37620.26</td>\n<td style="text-align: right;">38708.27</td>\n<td style="text-align: right;">36161.95</td>\n<td style="text-align: right;">36936.66</td>\n<td style="text-align: right;">92080.74</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-02-05</td>\n<td style="text-align: right;">36936.65</td>\n<td style="text-align: right;">38310.12</td>\n<td style="text-align: right;">36570.00</td>\n<td style="text-align: right;">38290.24</td>\n<td style="text-align: right;">66681.33</td>\n</tr>\n</tbody>\n</table>\n',"<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 6)</small>",'\n<table class="dataframe" data-quarto-postprocess="true" data-border="1">\n<thead>\n<tr class="header">\n<th data-quarto-table-cell-role="th">time</th>\n<th data-quarto-table-cell-role="th">open</th>\n<th data-quarto-table-cell-role="th">high</th>\n<th data-quarto-table-cell-role="th">low</th>\n<th data-quarto-table-cell-role="th">close</th>\n<th data-quarto-table-cell-role="th">volume</th>\n</tr>\n<tr class="odd">\n<th>date</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td>2021-02-01</td>\n<td>33092.97</td>\n<td>34717.27</td>\n<td>32296.16</td>\n<td>33526.37</td>\n<td>82718.276882</td>\n</tr>\n<tr class="even">\n<td>2021-02-02</td>\n<td>33517.09</td>\n<td>35984.33</td>\n<td>33418.0</td>\n<td>35466.24</td>\n<td>78056.65988</td>\n</tr>\n<tr class="odd">\n<td>2021-02-03</td>\n<td>35472.71</td>\n<td>37662.63</td>\n<td>35362.38</td>\n<td>37618.87</td>\n<td>80784.333663</td>\n</tr>\n<tr class="even">\n<td>2021-02-04</td>\n<td>37620.26</td>\n<td>38708.27</td>\n<td>36161.95</td>\n<td>36936.66</td>\n<td>92080.735898</td>\n</tr>\n<tr class="odd">\n<td>2021-02-05</td>\n<td>36936.65</td>\n<td>38310.12</td>\n<td>36570.0</td>\n<td>38290.24</td>\n<td>66681.334275</td>\n</tr>\n</tbody>\n</table>\n',"</div>",'\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time_new</th>\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-01</td>\n<td style="text-align: right;">31084.32</td>\n<td style="text-align: right;">33127.62</td>\n<td style="text-align: right;">29512.82</td>\n<td style="text-align: right;">32089.66</td>\n<td style="text-align: right;">112416.85</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-06</td>\n<td style="text-align: right;">38165.31</td>\n<td style="text-align: right;">40396.84</td>\n<td style="text-align: right;">35983.82</td>\n<td style="text-align: right;">39004.54</td>\n<td style="text-align: right;">118750.08</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-11</td>\n<td style="text-align: right;">36825.23</td>\n<td style="text-align: right;">38518.10</td>\n<td style="text-align: right;">33288.05</td>\n<td style="text-align: right;">36542.76</td>\n<td style="text-align: right;">146166.70</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-16</td>\n<td style="text-align: right;">36216.36</td>\n<td style="text-align: right;">37307.53</td>\n<td style="text-align: right;">34650.37</td>\n<td style="text-align: right;">35962.92</td>\n<td style="text-align: right;">81236.80</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-21</td>\n<td style="text-align: right;">32721.53</td>\n<td style="text-align: right;">34165.71</td>\n<td style="text-align: right;">30624.23</td>\n<td style="text-align: right;">32077.48</td>\n<td style="text-align: right;">97809.66</td>\n</tr>\n</tbody>\n</table>\n','\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-01</td>\n<td style="text-align: right;">31084.32</td>\n<td style="text-align: right;">33127.62</td>\n<td style="text-align: right;">29512.82</td>\n<td style="text-align: right;">32089.66</td>\n<td style="text-align: right;">112416.85</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-06</td>\n<td style="text-align: right;">38165.31</td>\n<td style="text-align: right;">40396.84</td>\n<td style="text-align: right;">35983.82</td>\n<td style="text-align: right;">39004.54</td>\n<td style="text-align: right;">118750.08</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-11</td>\n<td style="text-align: right;">36825.23</td>\n<td style="text-align: right;">38518.10</td>\n<td style="text-align: right;">33288.05</td>\n<td style="text-align: right;">36542.76</td>\n<td style="text-align: right;">146166.70</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-16</td>\n<td style="text-align: right;">36216.36</td>\n<td style="text-align: right;">37307.53</td>\n<td style="text-align: right;">34650.37</td>\n<td style="text-align: right;">35962.92</td>\n<td style="text-align: right;">81236.80</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-21</td>\n<td style="text-align: right;">32721.53</td>\n<td style="text-align: right;">34165.71</td>\n<td style="text-align: right;">30624.23</td>\n<td style="text-align: right;">32077.48</td>\n<td style="text-align: right;">97809.66</td>\n</tr>\n</tbody>\n</table>\n','\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-01</td>\n<td style="text-align: right;">31084.32</td>\n<td style="text-align: right;">33127.62</td>\n<td style="text-align: right;">29512.82</td>\n<td style="text-align: right;">32089.66</td>\n<td style="text-align: right;">112416.85</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-06</td>\n<td style="text-align: right;">38165.31</td>\n<td style="text-align: right;">40396.84</td>\n<td style="text-align: right;">35983.82</td>\n<td style="text-align: right;">39004.54</td>\n<td style="text-align: right;">118750.08</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-11</td>\n<td style="text-align: right;">36825.23</td>\n<td style="text-align: right;">38518.10</td>\n<td style="text-align: right;">33288.05</td>\n<td style="text-align: right;">36542.76</td>\n<td style="text-align: right;">146166.70</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-16</td>\n<td style="text-align: right;">36216.36</td>\n<td style="text-align: right;">37307.53</td>\n<td style="text-align: right;">34650.37</td>\n<td style="text-align: right;">35962.92</td>\n<td style="text-align: right;">81236.80</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-21</td>\n<td style="text-align: right;">32721.53</td>\n<td style="text-align: right;">34165.71</td>\n<td style="text-align: right;">30624.23</td>\n<td style="text-align: right;">32077.48</td>\n<td style="text-align: right;">97809.66</td>\n</tr>\n</tbody>\n</table>\n',"<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 6)</small>",'\n<table class="dataframe" data-quarto-postprocess="true" data-border="1">\n<thead>\n<tr class="header">\n<th data-quarto-table-cell-role="th">time</th>\n<th data-quarto-table-cell-role="th">open</th>\n<th data-quarto-table-cell-role="th">high</th>\n<th data-quarto-table-cell-role="th">low</th>\n<th data-quarto-table-cell-role="th">close</th>\n<th data-quarto-table-cell-role="th">volume</th>\n</tr>\n<tr class="odd">\n<th>date</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td>2020-12-29</td>\n<td>29127.665</td>\n<td>31450.0</td>\n<td>28785.55</td>\n<td>30755.01</td>\n<td>92088.399186</td>\n</tr>\n<tr class="even">\n<td>2021-01-03</td>\n<td>33577.028</td>\n<td>36008.464</td>\n<td>31916.198</td>\n<td>35027.986</td>\n<td>127574.470245</td>\n</tr>\n<tr class="odd">\n<td>2021-01-08</td>\n<td>38733.61</td>\n<td>39914.548</td>\n<td>34656.422</td>\n<td>37655.352</td>\n<td>143777.954392</td>\n</tr>\n<tr class="even">\n<td>2021-01-13</td>\n<td>36659.63</td>\n<td>38500.052</td>\n<td>34539.406</td>\n<td>37016.338</td>\n<td>102447.076833</td>\n</tr>\n<tr class="odd">\n<td>2021-01-18</td>\n<td>34933.922</td>\n<td>36232.334</td>\n<td>32593.012</td>\n<td>34357.258</td>\n<td>103530.722029</td>\n</tr>\n</tbody>\n</table>\n',"</div>",'\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time_new</th>\n<th style="text-align: right;">open_mean</th>\n<th style="text-align: right;">high_mean</th>\n<th style="text-align: right;">low_mean</th>\n<th style="text-align: right;">close_mean</th>\n<th style="text-align: right;">volume_mean</th>\n<th style="text-align: right;">open_sum</th>\n<th style="text-align: right;">high_sum</th>\n<th style="text-align: right;">low_sum</th>\n<th style="text-align: right;">close_sum</th>\n<th style="text-align: right;">volume_sum</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-01</td>\n<td style="text-align: right;">32305.78</td>\n<td style="text-align: right;">34706.05</td>\n<td style="text-align: right;">31021.73</td>\n<td style="text-align: right;">33807.14</td>\n<td style="text-align: right;">117435.59</td>\n<td style="text-align: right;">226140.5</td>\n<td style="text-align: right;">242942.3</td>\n<td style="text-align: right;">217152.1</td>\n<td style="text-align: right;">236650.0</td>\n<td style="text-align: right;">822049.1</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-08</td>\n<td style="text-align: right;">37869.80</td>\n<td style="text-align: right;">39646.11</td>\n<td style="text-align: right;">34623.33</td>\n<td style="text-align: right;">37827.52</td>\n<td style="text-align: right;">135188.30</td>\n<td style="text-align: right;">265088.6</td>\n<td style="text-align: right;">277522.7</td>\n<td style="text-align: right;">242363.3</td>\n<td style="text-align: right;">264792.6</td>\n<td style="text-align: right;">946318.1</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-15</td>\n<td style="text-align: right;">36527.89</td>\n<td style="text-align: right;">37412.20</td>\n<td style="text-align: right;">33961.55</td>\n<td style="text-align: right;">35343.85</td>\n<td style="text-align: right;">94212.72</td>\n<td style="text-align: right;">255695.2</td>\n<td style="text-align: right;">261885.4</td>\n<td style="text-align: right;">237730.9</td>\n<td style="text-align: right;">247406.9</td>\n<td style="text-align: right;">659489.0</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-22</td>\n<td style="text-align: right;">31888.55</td>\n<td style="text-align: right;">33498.81</td>\n<td style="text-align: right;">30424.48</td>\n<td style="text-align: right;">32248.01</td>\n<td style="text-align: right;">89649.94</td>\n<td style="text-align: right;">223219.8</td>\n<td style="text-align: right;">234491.7</td>\n<td style="text-align: right;">212971.4</td>\n<td style="text-align: right;">225736.0</td>\n<td style="text-align: right;">627549.6</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-29</td>\n<td style="text-align: right;">34511.48</td>\n<td style="text-align: right;">36411.44</td>\n<td style="text-align: right;">33450.08</td>\n<td style="text-align: right;">35022.31</td>\n<td style="text-align: right;">102728.42</td>\n<td style="text-align: right;">241580.4</td>\n<td style="text-align: right;">254880.1</td>\n<td style="text-align: right;">234150.6</td>\n<td style="text-align: right;">245156.2</td>\n<td style="text-align: right;">719099.0</td>\n</tr>\n</tbody>\n</table>\n','\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-01</td>\n<td style="text-align: right;">32305.78</td>\n<td style="text-align: right;">34706.05</td>\n<td style="text-align: right;">31021.73</td>\n<td style="text-align: right;">33807.14</td>\n<td style="text-align: right;">117435.59</td>\n<td style="text-align: right;">226140.5</td>\n<td style="text-align: right;">242942.3</td>\n<td style="text-align: right;">217152.1</td>\n<td style="text-align: right;">236650.0</td>\n<td style="text-align: right;">822049.1</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-08</td>\n<td style="text-align: right;">37869.80</td>\n<td style="text-align: right;">39646.11</td>\n<td style="text-align: right;">34623.33</td>\n<td style="text-align: right;">37827.52</td>\n<td style="text-align: right;">135188.30</td>\n<td style="text-align: right;">265088.6</td>\n<td style="text-align: right;">277522.7</td>\n<td style="text-align: right;">242363.3</td>\n<td style="text-align: right;">264792.6</td>\n<td style="text-align: right;">946318.1</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-15</td>\n<td style="text-align: right;">36527.89</td>\n<td style="text-align: right;">37412.20</td>\n<td style="text-align: right;">33961.55</td>\n<td style="text-align: right;">35343.85</td>\n<td style="text-align: right;">94212.72</td>\n<td style="text-align: right;">255695.2</td>\n<td style="text-align: right;">261885.4</td>\n<td style="text-align: right;">237730.9</td>\n<td style="text-align: right;">247406.9</td>\n<td style="text-align: right;">659489.0</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-22</td>\n<td style="text-align: right;">31888.55</td>\n<td style="text-align: right;">33498.81</td>\n<td style="text-align: right;">30424.48</td>\n<td style="text-align: right;">32248.01</td>\n<td style="text-align: right;">89649.94</td>\n<td style="text-align: right;">223219.8</td>\n<td style="text-align: right;">234491.7</td>\n<td style="text-align: right;">212971.4</td>\n<td style="text-align: right;">225736.0</td>\n<td style="text-align: right;">627549.6</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-29</td>\n<td style="text-align: right;">34511.48</td>\n<td style="text-align: right;">36411.44</td>\n<td style="text-align: right;">33450.08</td>\n<td style="text-align: right;">35022.31</td>\n<td style="text-align: right;">102728.42</td>\n<td style="text-align: right;">241580.4</td>\n<td style="text-align: right;">254880.1</td>\n<td style="text-align: right;">234150.6</td>\n<td style="text-align: right;">245156.2</td>\n<td style="text-align: right;">719099.0</td>\n</tr>\n</tbody>\n</table>\n','\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">open_mean</th>\n<th style="text-align: right;">open_sum</th>\n<th style="text-align: right;">high_mean</th>\n<th style="text-align: right;">high_sum</th>\n<th style="text-align: right;">low_mean</th>\n<th style="text-align: right;">low_sum</th>\n<th style="text-align: right;">close_mean</th>\n<th style="text-align: right;">close_sum</th>\n<th style="text-align: right;">volume_mean</th>\n<th style="text-align: right;">volume_sum</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-01</td>\n<td style="text-align: right;">32305.78</td>\n<td style="text-align: right;">226140.5</td>\n<td style="text-align: right;">34706.05</td>\n<td style="text-align: right;">242942.3</td>\n<td style="text-align: right;">31021.73</td>\n<td style="text-align: right;">217152.1</td>\n<td style="text-align: right;">33807.14</td>\n<td style="text-align: right;">236650.0</td>\n<td style="text-align: right;">117435.59</td>\n<td style="text-align: right;">822049.1</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-08</td>\n<td style="text-align: right;">37869.80</td>\n<td style="text-align: right;">265088.6</td>\n<td style="text-align: right;">39646.11</td>\n<td style="text-align: right;">277522.7</td>\n<td style="text-align: right;">34623.33</td>\n<td style="text-align: right;">242363.3</td>\n<td style="text-align: right;">37827.52</td>\n<td style="text-align: right;">264792.6</td>\n<td style="text-align: right;">135188.30</td>\n<td style="text-align: right;">946318.1</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-15</td>\n<td style="text-align: right;">36527.89</td>\n<td style="text-align: right;">255695.2</td>\n<td style="text-align: right;">37412.20</td>\n<td style="text-align: right;">261885.4</td>\n<td style="text-align: right;">33961.55</td>\n<td style="text-align: right;">237730.9</td>\n<td style="text-align: right;">35343.85</td>\n<td style="text-align: right;">247406.9</td>\n<td style="text-align: right;">94212.72</td>\n<td style="text-align: right;">659489.0</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-22</td>\n<td style="text-align: right;">31888.55</td>\n<td style="text-align: right;">223219.8</td>\n<td style="text-align: right;">33498.81</td>\n<td style="text-align: right;">234491.7</td>\n<td style="text-align: right;">30424.48</td>\n<td style="text-align: right;">212971.4</td>\n<td style="text-align: right;">32248.01</td>\n<td style="text-align: right;">225736.0</td>\n<td style="text-align: right;">89649.94</td>\n<td style="text-align: right;">627549.6</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-29</td>\n<td style="text-align: right;">34511.48</td>\n<td style="text-align: right;">241580.4</td>\n<td style="text-align: right;">36411.44</td>\n<td style="text-align: right;">254880.1</td>\n<td style="text-align: right;">33450.08</td>\n<td style="text-align: right;">234150.6</td>\n<td style="text-align: right;">35022.31</td>\n<td style="text-align: right;">245156.2</td>\n<td style="text-align: right;">102728.42</td>\n<td style="text-align: right;">719099.0</td>\n</tr>\n</tbody>\n</table>\n',"<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 11)</small>",'\n<table class="dataframe" data-quarto-postprocess="true" data-border="1">\n<thead>\n<tr class="header">\n<th data-quarto-table-cell-role="th">time</th>\n<th data-quarto-table-cell-role="th">open_mean</th>\n<th data-quarto-table-cell-role="th">high_mean</th>\n<th data-quarto-table-cell-role="th">low_mean</th>\n<th data-quarto-table-cell-role="th">close_mean</th>\n<th data-quarto-table-cell-role="th">volume_mean</th>\n<th data-quarto-table-cell-role="th">open_sum</th>\n<th data-quarto-table-cell-role="th">high_sum</th>\n<th data-quarto-table-cell-role="th">low_sum</th>\n<th data-quarto-table-cell-role="th">close_sum</th>\n<th data-quarto-table-cell-role="th">volume_sum</th>\n</tr>\n<tr class="odd">\n<th>date</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td>2020-12-28</td>\n<td>30143.926667</td>\n<td>32559.37</td>\n<td>29844.696667</td>\n<td>31503.356667</td>\n<td>101711.455041</td>\n<td>90431.78</td>\n<td>97678.11</td>\n<td>89534.09</td>\n<td>94510.07</td>\n<td>305134.365123</td>\n</tr>\n<tr class="even">\n<td>2021-01-04</td>\n<td>36545.192857</td>\n<td>38563.458571</td>\n<td>33992.73</td>\n<td>37280.132857</td>\n<td>121528.60945</td>\n<td>255816.35</td>\n<td>269944.21</td>\n<td>237949.11</td>\n<td>260960.93</td>\n<td>850700.266152</td>\n</tr>\n<tr class="odd">\n<td>2021-01-11</td>\n<td>36694.077143</td>\n<td>38199.0</td>\n<td>33664.004286</td>\n<td>36362.485714</td>\n<td>128191.382064</td>\n<td>256858.54</td>\n<td>267393.0</td>\n<td>235648.03</td>\n<td>254537.4</td>\n<td>897339.67445</td>\n</tr>\n<tr class="even">\n<td>2021-01-18</td>\n<td>34242.515714</td>\n<td>35384.095714</td>\n<td>32179.317143</td>\n<td>33732.027143</td>\n<td>91460.990826</td>\n<td>239697.61</td>\n<td>247688.67</td>\n<td>225255.22</td>\n<td>236124.19</td>\n<td>640226.935785</td>\n</tr>\n<tr class="odd">\n<td>2021-01-25</td>\n<td>32745.312857</td>\n<td>34563.677143</td>\n<td>31249.037143</td>\n<td>32865.862857</td>\n<td>106780.501216</td>\n<td>229217.19</td>\n<td>241945.74</td>\n<td>218743.26</td>\n<td>230061.04</td>\n<td>747463.508509</td>\n</tr>\n</tbody>\n</table>\n',"</div>",'\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-01 00:00:00</td>\n<td style="text-align: right;">28923.63</td>\n<td style="text-align: right;">29600</td>\n<td style="text-align: right;">28624.57</td>\n<td style="text-align: right;">29331.69</td>\n<td style="text-align: right;">54182.93</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-01 06:00:00</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-01 12:00:00</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-01 18:00:00</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-02 00:00:00</td>\n<td style="text-align: right;">29331.70</td>\n<td style="text-align: right;">33300</td>\n<td style="text-align: right;">28946.53</td>\n<td style="text-align: right;">32178.33</td>\n<td style="text-align: right;">129993.87</td>\n</tr>\n</tbody>\n</table>\n','\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-01 00:00:00</td>\n<td style="text-align: right;">28923.63</td>\n<td style="text-align: right;">29600</td>\n<td style="text-align: right;">28624.57</td>\n<td style="text-align: right;">29331.69</td>\n<td style="text-align: right;">54182.93</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-01 06:00:00</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-01 12:00:00</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-01 18:00:00</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-02 00:00:00</td>\n<td style="text-align: right;">29331.70</td>\n<td style="text-align: right;">33300</td>\n<td style="text-align: right;">28946.53</td>\n<td style="text-align: right;">32178.33</td>\n<td style="text-align: right;">129993.87</td>\n</tr>\n</tbody>\n</table>\n',"<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 6)</small>",'\n<table class="dataframe" data-quarto-postprocess="true" data-border="1">\n<thead>\n<tr class="header">\n<th data-quarto-table-cell-role="th">time</th>\n<th data-quarto-table-cell-role="th">open</th>\n<th data-quarto-table-cell-role="th">high</th>\n<th data-quarto-table-cell-role="th">low</th>\n<th data-quarto-table-cell-role="th">close</th>\n<th data-quarto-table-cell-role="th">volume</th>\n</tr>\n<tr class="odd">\n<th>date</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td>2021-01-01</td>\n<td>28923.63</td>\n<td>29600.0</td>\n<td>28624.57</td>\n<td>29331.69</td>\n<td>54182.925011</td>\n</tr>\n<tr class="even">\n<td>2021-01-01</td>\n<td>null</td>\n<td>null</td>\n<td>null</td>\n<td>null</td>\n<td>null</td>\n</tr>\n<tr class="odd">\n<td>2021-01-01</td>\n<td>null</td>\n<td>null</td>\n<td>null</td>\n<td>null</td>\n<td>null</td>\n</tr>\n<tr class="even">\n<td>2021-01-01</td>\n<td>null</td>\n<td>null</td>\n<td>null</td>\n<td>null</td>\n<td>null</td>\n</tr>\n<tr class="odd">\n<td>2021-01-02</td>\n<td>29331.7</td>\n<td>33300.0</td>\n<td>28946.53</td>\n<td>32178.33</td>\n<td>129993.873362</td>\n</tr>\n</tbody>\n</table>\n',"</div>",'\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">Raw</th>\n<th style="text-align: right;">28D MA</th>\n<th style="text-align: right;">Expanding Average</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-26</td>\n<td style="text-align: right;">32467.77</td>\n<td style="text-align: right;">35032.87</td>\n<td style="text-align: right;">35032.87</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-27</td>\n<td style="text-align: right;">30366.15</td>\n<td style="text-align: right;">34860.03</td>\n<td style="text-align: right;">34860.03</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-28</td>\n<td style="text-align: right;">33364.86</td>\n<td style="text-align: right;">34806.63</td>\n<td style="text-align: right;">34806.63</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-29</td>\n<td style="text-align: right;">34252.20</td>\n<td style="text-align: right;">34982.36</td>\n<td style="text-align: right;">34787.51</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-30</td>\n<td style="text-align: right;">34262.88</td>\n<td style="text-align: right;">35056.81</td>\n<td style="text-align: right;">34770.02</td>\n</tr>\n</tbody>\n</table>\n','\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">Raw</th>\n<th style="text-align: right;">28D MA</th>\n<th style="text-align: right;">Expanding Average</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-26</td>\n<td style="text-align: right;">32467.77</td>\n<td style="text-align: right;">35032.87</td>\n<td style="text-align: right;">35032.87</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-27</td>\n<td style="text-align: right;">30366.15</td>\n<td style="text-align: right;">34860.03</td>\n<td style="text-align: right;">34860.03</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-28</td>\n<td style="text-align: right;">33364.86</td>\n<td style="text-align: right;">34806.63</td>\n<td style="text-align: right;">34806.63</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-29</td>\n<td style="text-align: right;">34252.20</td>\n<td style="text-align: right;">34982.36</td>\n<td style="text-align: right;">34787.51</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-30</td>\n<td style="text-align: right;">34262.88</td>\n<td style="text-align: right;">35056.81</td>\n<td style="text-align: right;">34770.02</td>\n</tr>\n</tbody>\n</table>\n','\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">Raw</th>\n<th style="text-align: right;">28D MA</th>\n<th style="text-align: right;">Expanding Average</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-26</td>\n<td style="text-align: right;">32467.77</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">35032.87</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-27</td>\n<td style="text-align: right;">30366.15</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">34860.03</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-28</td>\n<td style="text-align: right;">33364.86</td>\n<td style="text-align: right;">34806.63</td>\n<td style="text-align: right;">34806.63</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-29</td>\n<td style="text-align: right;">34252.20</td>\n<td style="text-align: right;">34982.36</td>\n<td style="text-align: right;">34787.51</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-30</td>\n<td style="text-align: right;">34262.88</td>\n<td style="text-align: right;">35056.81</td>\n<td style="text-align: right;">34770.02</td>\n</tr>\n</tbody>\n</table>\n',"<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 4)</small>",'\n<table class="dataframe" data-quarto-postprocess="true" data-border="1">\n<thead>\n<tr class="header">\n<th data-quarto-table-cell-role="th">time</th>\n<th data-quarto-table-cell-role="th">Raw</th>\n<th data-quarto-table-cell-role="th">28D MA</th>\n<th data-quarto-table-cell-role="th">Expanding Average</th>\n</tr>\n<tr class="odd">\n<th>date</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td>2021-01-26</td>\n<td>32467.77</td>\n<td>null</td>\n<td>33735.354074</td>\n</tr>\n<tr class="even">\n<td>2021-01-27</td>\n<td>30366.15</td>\n<td>null</td>\n<td>33615.025357</td>\n</tr>\n<tr class="odd">\n<td>2021-01-28</td>\n<td>33364.86</td>\n<td>34806.6275</td>\n<td>33606.398966</td>\n</tr>\n<tr class="even">\n<td>2021-01-29</td>\n<td>34252.2</td>\n<td>34982.36</td>\n<td>33627.925667</td>\n</tr>\n<tr class="odd">\n<td>2021-01-30</td>\n<td>34262.88</td>\n<td>35056.808214</td>\n<td>33648.408065</td>\n</tr>\n</tbody>\n</table>\n',"</div>",'\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">mean</th>\n<th style="text-align: right;">std</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-13</td>\n<td style="text-align: right;">34860.03</td>\n<td style="text-align: right;">3092.516</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-14</td>\n<td style="text-align: right;">34806.63</td>\n<td style="text-align: right;">3047.833</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-15</td>\n<td style="text-align: right;">34787.51</td>\n<td style="text-align: right;">2994.683</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-16</td>\n<td style="text-align: right;">34770.02</td>\n<td style="text-align: right;">2944.156</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-17</td>\n<td style="text-align: right;">34895.40</td>\n<td style="text-align: right;">2780.095</td>\n</tr>\n</tbody>\n</table>\n','\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">mean</th>\n<th style="text-align: right;">std</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-13</td>\n<td style="text-align: right;">34860.03</td>\n<td style="text-align: right;">3092.516</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-14</td>\n<td style="text-align: right;">34806.63</td>\n<td style="text-align: right;">3047.833</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-15</td>\n<td style="text-align: right;">34787.51</td>\n<td style="text-align: right;">2994.683</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-16</td>\n<td style="text-align: right;">34770.02</td>\n<td style="text-align: right;">2944.156</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-17</td>\n<td style="text-align: right;">34895.40</td>\n<td style="text-align: right;">2780.095</td>\n</tr>\n</tbody>\n</table>\n','\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">mean</th>\n<th style="text-align: right;">std</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2021-01-13</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-14</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-15</td>\n<td style="text-align: right;">NA</td>\n<td style="text-align: right;">NA</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-16</td>\n<td style="text-align: right;">34770.02</td>\n<td style="text-align: right;">2944.156</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-17</td>\n<td style="text-align: right;">34895.40</td>\n<td style="text-align: right;">2780.095</td>\n</tr>\n</tbody>\n</table>\n',"<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 3)</small>",'\n<table class="dataframe" data-quarto-postprocess="true" data-border="1">\n<thead>\n<tr class="header">\n<th data-quarto-table-cell-role="th">time</th>\n<th data-quarto-table-cell-role="th">mean</th>\n<th data-quarto-table-cell-role="th">std</th>\n</tr>\n<tr class="odd">\n<th>date</th>\n<th>f64</th>\n<th>f64</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td>2021-01-13</td>\n<td>null</td>\n<td>null</td>\n</tr>\n<tr class="even">\n<td>2021-01-14</td>\n<td>null</td>\n<td>null</td>\n</tr>\n<tr class="odd">\n<td>2021-01-15</td>\n<td>null</td>\n<td>null</td>\n</tr>\n<tr class="even">\n<td>2021-01-16</td>\n<td>34770.021667</td>\n<td>2944.155675</td>\n</tr>\n<tr class="odd">\n<td>2021-01-17</td>\n<td>34895.398</td>\n<td>2780.095304</td>\n</tr>\n</tbody>\n</table>\n',"</div>",'\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n<th style="text-align: left;">time_new</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: right;">28923.63</td>\n<td style="text-align: right;">29600.00</td>\n<td style="text-align: right;">28624.57</td>\n<td style="text-align: right;">29331.69</td>\n<td style="text-align: right;">54182.93</td>\n<td style="text-align: left;">2020-12-31 19:00:00</td>\n</tr>\n<tr class="even">\n<td style="text-align: right;">29331.70</td>\n<td style="text-align: right;">33300.00</td>\n<td style="text-align: right;">28946.53</td>\n<td style="text-align: right;">32178.33</td>\n<td style="text-align: right;">129993.87</td>\n<td style="text-align: left;">2021-01-01 19:00:00</td>\n</tr>\n<tr class="odd">\n<td style="text-align: right;">32176.45</td>\n<td style="text-align: right;">34778.11</td>\n<td style="text-align: right;">31962.99</td>\n<td style="text-align: right;">33000.05</td>\n<td style="text-align: right;">120957.57</td>\n<td style="text-align: left;">2021-01-02 19:00:00</td>\n</tr>\n<tr class="even">\n<td style="text-align: right;">33000.05</td>\n<td style="text-align: right;">33600.00</td>\n<td style="text-align: right;">28130.00</td>\n<td style="text-align: right;">31988.71</td>\n<td style="text-align: right;">140899.89</td>\n<td style="text-align: left;">2021-01-03 19:00:00</td>\n</tr>\n<tr class="odd">\n<td style="text-align: right;">31989.75</td>\n<td style="text-align: right;">34360.00</td>\n<td style="text-align: right;">29900.00</td>\n<td style="text-align: right;">33949.53</td>\n<td style="text-align: right;">116050.00</td>\n<td style="text-align: left;">2021-01-04 19:00:00</td>\n</tr>\n</tbody>\n</table>\n','\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2020-12-31 19:00:00</td>\n<td style="text-align: right;">28923.63</td>\n<td style="text-align: right;">29600.00</td>\n<td style="text-align: right;">28624.57</td>\n<td style="text-align: right;">29331.69</td>\n<td style="text-align: right;">54182.93</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-01 19:00:00</td>\n<td style="text-align: right;">29331.70</td>\n<td style="text-align: right;">33300.00</td>\n<td style="text-align: right;">28946.53</td>\n<td style="text-align: right;">32178.33</td>\n<td style="text-align: right;">129993.87</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-02 19:00:00</td>\n<td style="text-align: right;">32176.45</td>\n<td style="text-align: right;">34778.11</td>\n<td style="text-align: right;">31962.99</td>\n<td style="text-align: right;">33000.05</td>\n<td style="text-align: right;">120957.57</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-03 19:00:00</td>\n<td style="text-align: right;">33000.05</td>\n<td style="text-align: right;">33600.00</td>\n<td style="text-align: right;">28130.00</td>\n<td style="text-align: right;">31988.71</td>\n<td style="text-align: right;">140899.89</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-04 19:00:00</td>\n<td style="text-align: right;">31989.75</td>\n<td style="text-align: right;">34360.00</td>\n<td style="text-align: right;">29900.00</td>\n<td style="text-align: right;">33949.53</td>\n<td style="text-align: right;">116050.00</td>\n</tr>\n</tbody>\n</table>\n','\n<table>\n<thead>\n<tr class="header">\n<th style="text-align: left;">time</th>\n<th style="text-align: right;">open</th>\n<th style="text-align: right;">high</th>\n<th style="text-align: right;">low</th>\n<th style="text-align: right;">close</th>\n<th style="text-align: right;">volume</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td style="text-align: left;">2020-12-31 19:00:00</td>\n<td style="text-align: right;">28923.63</td>\n<td style="text-align: right;">29600.00</td>\n<td style="text-align: right;">28624.57</td>\n<td style="text-align: right;">29331.69</td>\n<td style="text-align: right;">54182.93</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-01 19:00:00</td>\n<td style="text-align: right;">29331.70</td>\n<td style="text-align: right;">33300.00</td>\n<td style="text-align: right;">28946.53</td>\n<td style="text-align: right;">32178.33</td>\n<td style="text-align: right;">129993.87</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-02 19:00:00</td>\n<td style="text-align: right;">32176.45</td>\n<td style="text-align: right;">34778.11</td>\n<td style="text-align: right;">31962.99</td>\n<td style="text-align: right;">33000.05</td>\n<td style="text-align: right;">120957.57</td>\n</tr>\n<tr class="even">\n<td style="text-align: left;">2021-01-03 19:00:00</td>\n<td style="text-align: right;">33000.05</td>\n<td style="text-align: right;">33600.00</td>\n<td style="text-align: right;">28130.00</td>\n<td style="text-align: right;">31988.71</td>\n<td style="text-align: right;">140899.89</td>\n</tr>\n<tr class="odd">\n<td style="text-align: left;">2021-01-04 19:00:00</td>\n<td style="text-align: right;">31989.75</td>\n<td style="text-align: right;">34360.00</td>\n<td style="text-align: right;">29900.00</td>\n<td style="text-align: right;">33949.53</td>\n<td style="text-align: right;">116050.00</td>\n</tr>\n</tbody>\n</table>\n',"<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 6)</small>",'\n<table class="dataframe" data-quarto-postprocess="true" data-border="1">\n<thead>\n<tr class="header">\n<th data-quarto-table-cell-role="th">time</th>\n<th data-quarto-table-cell-role="th">open</th>\n<th data-quarto-table-cell-role="th">high</th>\n<th data-quarto-table-cell-role="th">low</th>\n<th data-quarto-table-cell-role="th">close</th>\n<th data-quarto-table-cell-role="th">volume</th>\n</tr>\n<tr class="odd">\n<th>datetime[\u03bcs, US/Eastern]</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n<th>f64</th>\n</tr>\n</thead>\n<tbody>\n<tr class="odd">\n<td>2020-12-31 19:00:00 EST</td>\n<td>28923.63</td>\n<td>29600.0</td>\n<td>28624.57</td>\n<td>29331.69</td>\n<td>54182.925011</td>\n</tr>\n<tr class="even">\n<td>2021-01-01 19:00:00 EST</td>\n<td>29331.7</td>\n<td>33300.0</td>\n<td>28946.53</td>\n<td>32178.33</td>\n<td>129993.873362</td>\n</tr>\n<tr class="odd">\n<td>2021-01-02 19:00:00 EST</td>\n<td>32176.45</td>\n<td>34778.11</td>\n<td>31962.99</td>\n<td>33000.05</td>\n<td>120957.56675</td>\n</tr>\n<tr class="even">\n<td>2021-01-03 19:00:00 EST</td>\n<td>33000.05</td>\n<td>33600.0</td>\n<td>28130.0</td>\n<td>31988.71</td>\n<td>140899.88569</td>\n</tr>\n<tr class="odd">\n<td>2021-01-04 19:00:00 EST</td>\n<td>31989.75</td>\n<td>34360.0</td>\n<td>29900.0</td>\n<td>33949.53</td>\n<td>116049.997038</td>\n</tr>\n</tbody>\n</table>\n',"</div>"],c=[{value:"Preparing Data",id:"preparing-data",level:2},{value:"Download",id:"download",level:3},{value:"Load the Data",id:"load-the-data",level:3},{value:"Filtering",id:"filtering",level:2},{value:"Downsampling",id:"downsampling",level:2},{value:"Upsampling",id:"upsampling",level:2},{value:"Window Functions",id:"window-functions",level:2},{value:"Moving Average, Cumulative Avarage",id:"sec-moving-ave",level:3},{value:"Combining Rolling Aggregations",id:"combining-rolling-aggregations",level:3},{value:"Timezones",id:"timezones",level:2}];function x(t){const e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",sup:"sup",ul:"ul",...(0,d.a)(),...t.components},{Details:s}=e;return s||function(t,e){throw new Error("Expected "+(e?"component":"object")+" `"+t+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.admonition,{type:"note",children:(0,l.jsxs)(e.p,{children:["This page is based on the chapter ",(0,l.jsx)(e.a,{href:"https://kevinheavey.github.io/modern-polars/timeseries.html",children:"\u201cTimeseries\u201d"})," of the Modern Polars book."]})}),"\n",(0,l.jsx)(e.h2,{id:"preparing-data",children:"Preparing Data"}),"\n",(0,l.jsx)(e.admonition,{type:"important",children:(0,l.jsxs)(e.p,{children:["Since the PRQL and SQL results shown on this page are after being converted to R DataFrame via knitr, they have been converted from DuckDB types to R types. So ",(0,l.jsx)(e.code,{children:"NULL"})," in DuckDB is shown as ",(0,l.jsx)(e.code,{children:"NA"}),"."]})}),"\n",(0,l.jsx)(e.h3,{id:"download",children:"Download"}),"\n",(0,l.jsxs)(e.p,{children:["Download the data from ",(0,l.jsx)(e.a,{href:"https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md",children:"Binance REST API"})," and write it to a Parquet file."]}),"\n",(0,l.jsxs)(e.p,{children:["This document uses R to download the data from the source here, but we can also download and use the Parquet file included in the ",(0,l.jsx)(e.a,{href:"https://github.com/kevinheavey/modern-polars/blob/master/data/ohlcv.pq",children:"kevinheavey/modern-polars"})," GitHub repository."]}),"\n",(0,l.jsxs)(a.Z,{children:[(0,l.jsx)(i.Z,{value:"R",children:(0,l.jsxs)(s,{class:"code-fold",children:[(0,l.jsx)("summary",{children:"Code"}),(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'data_path <- "data/ohlcv.parquet"\n\nif (!fs::file_exists(data_path)) {\n  fs::dir_create(fs::path_dir(data_path))\n\n  .epoch_ms <- function(dt) {\n    dt |>\n      lubridate::as_datetime() |>\n      (\\(x) (as.integer(x) * 1000))()\n  }\n\n  .start <- lubridate::make_datetime(2021, 1, 1) |> .epoch_ms()\n  .end <- lubridate::make_datetime(2022, 1, 1) |> .epoch_ms()\n\n  .url <- glue::glue(\n    "https://api.binance.com/api/v3/klines?symbol=BTCUSDT&",\n    "interval=1d&startTime={.start}&endTime={.end}"\n  )\n\n  .res <- jsonlite::read_json(.url)\n\n  time_col <- "time"\n  ohlcv_cols <- c(\n    "open",\n    "high",\n    "low",\n    "close",\n    "volume"\n  )\n  cols_to_use <- c(time_col, ohlcv_cols)\n  cols <- c(cols_to_use, glue::glue("ignore_{i}", i = 1:6))\n\n  df <- .res |>\n    tibble::enframe(name = NULL) |>\n    tidyr::unnest_wider(value, names_sep = "_") |>\n    rlang::set_names({{ cols }}) |>\n    dplyr::mutate(\n      dplyr::across({{ time_col }}, \\(x) lubridate::as_datetime(x / 1000) |> lubridate::as_date()),\n      dplyr::across({{ ohlcv_cols }}, as.numeric),\n      .keep = "none"\n    )\n\n  # Unlike the Python client, the duckdb R client does not (yet) have automatic DataFrame registration.\n  # (duckdb/duckdb#6771)\n  con_tmp <- DBI::dbConnect(duckdb::duckdb(), ":memory:")\n  duckdb::duckdb_register(con_tmp, "df", df)\n  duckdb:::sql(glue::glue("COPY df TO \'{data_path}\' (FORMAT PARQUET)"), con_tmp)\n  DBI::dbDisconnect(con_tmp)\n}\n'})})]})}),(0,l.jsxs)(i.Z,{value:"Shell",children:[(0,l.jsxs)(e.p,{children:["This is a sample command to download the Parquet file from the ",(0,l.jsx)(e.code,{children:"kevinheavey/modern-polars"})," GitHub repository."]}),(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-bash",metastring:'showLineNumbers title="Terminal"',children:"mkdir data\ncurl -sL https://github.com/kevinheavey/modern-polars/raw/d67d6f95ce0de8aad5492c4497ac4c3e33d696e8/data/ohlcv.pq -o data/ohlcv.parquet\n"})})]})]}),"\n",(0,l.jsx)(e.h3,{id:"load-the-data",children:"Load the Data"}),"\n",(0,l.jsx)(e.p,{children:"After the Parquet file is ready, load that into DuckDB (in-memory) database table, R DataFrame, and Python polars.LazyFrame."}),"\n",(0,l.jsxs)(a.Z,{children:[(0,l.jsxs)(i.Z,{value:"DuckDB",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"CREATE TABLE tab AS FROM 'data/ohlcv.parquet'\n"})}),(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"FROM tab\nLIMIT 5\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[0]}})]}),(0,l.jsxs)(i.Z,{value:"R DataFrame",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:"library(dplyr, warn.conflicts = FALSE)\n\ndf <- duckdb:::sql(\"FROM 'data/ohlcv.parquet'\")\n"})}),(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:"df |> head(5)\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[1]}})]}),(0,l.jsxs)(i.Z,{value:"Python polars.LazyFrame",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'import polars as pl\n\nlf = pl.scan_parquet("data/ohlcv.parquet")\n'})}),(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"lf.fetch(5)\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[2]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[3]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[4]}})]})]}),"\n",(0,l.jsx)(e.h2,{id:"filtering",children:"Filtering"}),"\n",(0,l.jsxs)(a.Z,{children:[(0,l.jsxs)(i.Z,{value:"PRQL DuckDB",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-elm",metastring:"showLineNumbers",children:"from tab\nfilter s\"date_part(['year', 'month'], time) = {{year: 2021, month: 2}}\"\ntake 5\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[5]}})]}),(0,l.jsxs)(i.Z,{value:"SQL DuckDB",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"FROM tab\nWHERE date_part(['year', 'month'], time) = {year: 2021, month: 2}\nLIMIT 5\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[6]}})]}),(0,l.jsxs)(i.Z,{value:"dplyr R",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'df |>\n  filter(\n    lubridate::floor_date(time, "month") == lubridate::make_datetime(2021, 2)\n  ) |>\n  head(5)\n'})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[7]}})]}),(0,l.jsxs)(i.Z,{value:"Python Polars",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'(\n    lf.filter((pl.col("time").dt.year() == 2021) & (pl.col("time").dt.month() == 2))\n    .head(5)\n    .collect()\n)\n'})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[8]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[9]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[10]}})]})]}),"\n",(0,l.jsx)(e.h2,{id:"downsampling",children:"Downsampling"}),"\n",(0,l.jsxs)(e.p,{children:["It is important to note carefully how units such as ",(0,l.jsx)(e.code,{children:"5 days"})," or ",(0,l.jsx)(e.code,{children:"1 week"})," actually work. In other words, where to start counting ",(0,l.jsx)(e.code,{children:"5 days"})," or ",(0,l.jsx)(e.code,{children:"1 week"})," could be completely different in each system."]}),"\n",(0,l.jsxs)(e.p,{children:["Here, we should note that ",(0,l.jsx)(e.code,{children:"time_bucket"})," in DuckDB, ",(0,l.jsx)(e.code,{children:"lubridate::floor_date"})," in R, and ",(0,l.jsx)(e.code,{children:"groupby_dynamic"})," in Polars have completely different initial starting points by default."]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsxs)(e.p,{children:["The DuckDB function ",(0,l.jsx)(e.code,{children:"time_bucket"}),"\u2019s origin defaults to ",(0,l.jsx)(e.code,{children:"2000-01-03 00:00:00+00"})," for days or weeks interval.",(0,l.jsx)(e.sup,{children:(0,l.jsx)(e.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})})]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsxs)(e.p,{children:["In the R ",(0,l.jsx)(e.code,{children:"lubridate::floor_date"})," function, timestamp is floored using the number of days elapsed since the beginning of every month when specifying ",(0,l.jsx)(e.code,{children:'"5 days"'})," to the ",(0,l.jsx)(e.code,{children:"unit"})," argument."]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'lubridate::as_date(c("2023-01-31", "2023-02-01")) |>\n  lubridate::floor_date("5 days")\n'})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-text",children:'[1] "2023-01-31" "2023-02-01"\n'})}),"\n",(0,l.jsxs)(e.p,{children:["And when ",(0,l.jsx)(e.code,{children:'"1 week"'})," to the ",(0,l.jsx)(e.code,{children:"unit"})," argument, it is floored to the nearest week, Sunday through Saturday."]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'lubridate::as_date(c("2023-01-31", "2023-02-01")) |>\n  lubridate::floor_date("1 week")\n'})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-text",children:'[1] "2023-01-29" "2023-01-29"\n'})}),"\n",(0,l.jsxs)(e.p,{children:["To start from an arbitrary origin, all breaks must be specified as a vector in the unit argument.",(0,l.jsx)(e.sup,{children:(0,l.jsx)(e.a,{href:"#user-content-fn-2",id:"user-content-fnref-2","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})})]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'lubridate::as_date(c("2023-01-31", "2023-02-01")) |>\n  lubridate::floor_date(lubridate::make_date(2023, 1, 31))\n'})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-text",children:'[1] "2023-01-31" "2023-01-31"\n'})}),"\n"]}),"\n",(0,l.jsxs)(e.li,{children:["\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.code,{children:"groupby_dynamic"})," of Polars, the ",(0,l.jsx)(e.code,{children:"offset"})," parameter to specify the origin point, is negative ",(0,l.jsx)(e.code,{children:"every"})," by default.",(0,l.jsx)(e.sup,{children:(0,l.jsx)(e.a,{href:"#user-content-fn-3",id:"user-content-fnref-3","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"3"})})]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(a.Z,{children:[(0,l.jsxs)(i.Z,{value:"PRQL DuckDB",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-elm",metastring:"showLineNumbers",children:'from tab\nderive {\n  time_new = s"""\n    time_bucket(INTERVAL \'5 days\', time, (FROM tab SELECT min(time)))\n  """\n}\ngroup {time_new} (\n  aggregate {\n    open = average open,\n    high = average high,\n    low = average low,\n    close = average close,\n    volume = average volume\n  }\n)\nsort time_new\ntake 5\n'})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[11]}})]}),(0,l.jsxs)(i.Z,{value:"SQL DuckDB",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"WITH _tab1 AS (\n  FROM tab\n  SELECT\n    * REPLACE (time_bucket(INTERVAL '5 days', time, (FROM tab SELECT min(time)))) AS time\n)\n\nFROM _tab1\nSELECT\n  time,\n  avg(COLUMNS(x -> x NOT IN ('time')))\nGROUP BY time\nORDER BY time\nLIMIT 5\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[12]}})]}),(0,l.jsxs)(i.Z,{value:"dplyr R",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:"df |>\n  mutate(\n    time = time |>\n      (\\(x) lubridate::floor_date(x, seq(min(x), max(x), by = 5)))()\n  ) |>\n  summarise(across(everything(), mean), .by = time) |>\n  head(5)\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[13]}})]}),(0,l.jsxs)(i.Z,{value:"Python Polars",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'(\n    lf.sort("time")\n    .groupby_dynamic("time", every="5d")\n    .agg(pl.col(pl.Float64).mean())\n    .head(5)\n    .collect()\n)\n'})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[14]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[15]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[16]}})]})]}),"\n",(0,l.jsxs)(a.Z,{children:[(0,l.jsxs)(i.Z,{value:"PRQL DuckDB",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-elm",metastring:"showLineNumbers",children:'from tab\nderive {\n  time_new = s"""\n    time_bucket(INTERVAL \'7 days\', time, (FROM tab SELECT min(time)))\n  """\n}\ngroup {time_new} (\n  aggregate {\n    open_mean = average open,\n    high_mean = average high,\n    low_mean = average low,\n    close_mean = average close,\n    volume_mean = average volume,\n    open_sum = sum open,\n    high_sum = sum high,\n    low_sum = sum low,\n    close_sum = sum close,\n    volume_sum = sum volume\n  }\n)\nsort time_new\ntake 5\n'})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[17]}})]}),(0,l.jsxs)(i.Z,{value:"SQL DukcDB",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"WITH _tab1 AS (\n  FROM tab\n  SELECT\n    * REPLACE (time_bucket(INTERVAL '7 days', time, (FROM tab SELECT min(time)))) AS time\n)\n\nFROM _tab1\nSELECT\n  time,\n  avg(COLUMNS(x -> x NOT IN ('time'))),\n  sum(COLUMNS(x -> x NOT IN ('time')))\nGROUP BY time\nORDER BY time\nLIMIT 5\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[18]}})]}),(0,l.jsxs)(i.Z,{value:"dplyr R",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'df |>\n  mutate(\n    time = time |>\n      (\\(x) lubridate::floor_date(x, seq(min(x), max(x), by = 7)))()\n  ) |>\n  summarise(\n    across(\n      everything(),\n      list(mean = mean, sum = sum),\n      .names = "{.col}_{.fn}"\n    ),\n    .by = time\n  ) |>\n  head(5)\n'})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[19]}})]}),(0,l.jsxs)(i.Z,{value:"Python Polars",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'(\n    lf.sort("time")\n    .groupby_dynamic("time", every="1w")\n    .agg(\n        [\n            pl.col(pl.Float64).mean().suffix("_mean"),\n            pl.col(pl.Float64).sum().suffix("_sum"),\n        ]\n    )\n    .head(5)\n    .collect()\n)\n'})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[20]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[21]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[22]}})]})]}),"\n",(0,l.jsx)(e.h2,{id:"upsampling",children:"Upsampling"}),"\n",(0,l.jsxs)(e.p,{children:["The way to use a function like ",(0,l.jsx)(e.code,{children:"generate_series"})," to generate sequential values and then join them is general-purpose."]}),"\n",(0,l.jsxs)(e.p,{children:["In R, we can also use dedicated functions like ",(0,l.jsx)(e.a,{href:"https://business-science.github.io/timetk/reference/pad_by_time.html",children:(0,l.jsx)(e.code,{children:"timetk::pad_by_time"})}),"."]}),"\n",(0,l.jsxs)(a.Z,{children:[(0,l.jsxs)(i.Z,{value:"PRQL DuckDB",children:[(0,l.jsx)(e.admonition,{type:"important",children:(0,l.jsxs)(e.p,{children:["This example does not work with prql-compiler 0.11.1. (",(0,l.jsx)(e.a,{href:"https://github.com/PRQL/prql/issues/3129",children:"PRQL/prql#3129"}),")"]})}),(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-prql",metastring:"showLineNumbers",children:'let _tab1 = s"""\n  SELECT\n    generate_series(\n      (SELECT min(time)),\n      (SELECT max(time)),\n      INTERVAL \'6 hours\'\n    ).unnest() AS time\n  FROM tab\n"""\n\nfrom _tab1\njoin side:left tab (==time)\nsort tab.time\nselect !{tab.time}\ntake 5\n'})})]}),(0,l.jsxs)(i.Z,{value:"SQL DuckDB",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"WITH _tab1 AS (\n  SELECT\n    generate_series(\n      (FROM tab SELECT min(time)),\n      (FROM tab SELECT max(time)),\n      INTERVAL '6 hours'\n    ).unnest() AS time\n)\n\nFROM _tab1\nLEFT JOIN tab USING (time)\nORDER BY time\nLIMIT 5\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[23]}})]}),(0,l.jsxs)(i.Z,{value:"dplyr R",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'.grid <- df$time |>\n  lubridate::as_datetime() |>\n  (\\(x) seq(min(x), max(x), by = "6 hours"))() |>\n  tibble::tibble(time = _)\n\n.grid |>\n  left_join(df, by = "time") |>\n  head(5)\n'})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[24]}})]}),(0,l.jsxs)(i.Z,{value:"Python Polars",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'lf.collect().sort("time").upsample("time", every="6h").head(5)\n'})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[25]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[26]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[27]}})]})]}),"\n",(0,l.jsx)(e.h2,{id:"window-functions",children:"Window Functions"}),"\n",(0,l.jsx)(e.p,{children:"It is necessary to be careful how the Window function calculates if the width of the window is less than the specified value."}),"\n",(0,l.jsx)(e.h3,{id:"sec-moving-ave",children:"Moving Average, Cumulative Avarage"}),"\n",(0,l.jsx)(e.p,{children:"PRQL has a dedicated way of applying the window to the entire table. For the others, use a individual function for each column."}),"\n",(0,l.jsxs)(e.p,{children:["In R, base R have some window functions like ",(0,l.jsx)(e.code,{children:"cumsum"}),", but none like cumulative avarage. dplyr complements this with several functions, including ",(0,l.jsx)(e.code,{children:"cummean"}),"."]}),"\n",(0,l.jsx)(e.p,{children:"Polars does not yet have a dedicated function to compute cumulative averages, so we must use cumulative sums to compute them."}),"\n",(0,l.jsx)(e.admonition,{type:"note",children:(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.a,{href:"https://tomaugspurger.github.io/posts/modern-7-timeseries/#rolling--expanding--ew",children:"The original Modern Pandas post"})," and ",(0,l.jsx)(e.a,{href:"https://kevinheavey.github.io/modern-polars/timeseries.html#rolling-expanding-ew",children:"the Modern Polars book"})," have a exponentially weighted (EW) calculation example in addition. But DuckDB does not have a dedicated function to do this, so it is omitted here."]})}),"\n",(0,l.jsxs)(a.Z,{children:[(0,l.jsxs)(i.Z,{value:"PRQL DuckDB",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-elm",metastring:"showLineNumbers",children:"from tab\nsort this.time\nwindow rolling:28 (\n  derive {`28D MA` = average close}\n)\nwindow rows:..0 (\n  derive {`Expanding Average` = average close}\n)\nselect {\n  this.time,\n  Raw = close,\n  `28D MA`,\n  `Expanding Average`\n}\ntake 26..30\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[28]}})]}),(0,l.jsxs)(i.Z,{value:"SQL DuckDB",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:'FROM tab\nSELECT\n  time,\n  close AS "Raw",\n  avg(close) OVER (\n    ORDER BY time\n    ROWS BETWEEN 27 PRECEDING AND CURRENT ROW\n  ) AS "28D MA",\n  avg(close) OVER (\n    ORDER BY time\n    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n  ) AS "Expanding Average"\nLIMIT 5 OFFSET 25\n'})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[29]}})]}),(0,l.jsxs)(i.Z,{value:"dplyr R",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'roll_and_expand <- df |>\n  arrange(time) |>\n  mutate(\n    time,\n    Raw = close,\n    `28D MA` = close |>\n      slider::slide_vec(mean, .before = 27, .complete = TRUE),\n    `Expanding Average` = cummean(close),\n    .keep = "none"\n  )\n'})}),(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:"roll_and_expand |>\n  slice(26:30)\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[30]}})]}),(0,l.jsxs)(i.Z,{value:"Python Polars",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'close = pl.col("close")\n\nroll_and_expand = lf.sort("time").select(\n    [\n        pl.col("time"),\n        close.alias("Raw"),\n        close.rolling_mean(28).alias("28D MA"),\n        close.alias("Expanding Average").cum_sum() / (close.cum_count() + 1),\n    ]\n)\n'})}),(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"roll_and_expand.head(30).tail(5).collect()\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[31]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[32]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[33]}})]})]}),"\n",(0,l.jsxs)(e.p,{children:["Here, DuckDB also calculates avarage for cases where the window width is less than 28 for the ",(0,l.jsx)(e.code,{children:"28D MA"})," column, whereas R ",(0,l.jsx)(e.code,{children:"slider::slide_vec(.complete = TRUE)"})," and Polars ",(0,l.jsx)(e.code,{children:"rolling_mean"})," make them missing values. If we are using DuckDB and need to make replacement for ",(0,l.jsx)(e.code,{children:"NULL"}),", we need to add further processing."]}),"\n",(0,l.jsx)(e.p,{children:"Plotting the results of dplyr shows the following."}),"\n",(0,l.jsxs)(s,{class:"code-fold",children:[(0,l.jsx)("summary",{children:"Code"}),(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'library(ggplot2)\n\nroll_and_expand |>\n  tidyr::pivot_longer(cols = !time) |>\n  ggplot(aes(time, value, colour = name)) +\n  geom_line() +\n  theme_linedraw() +\n  labs(y = "Close ($)") +\n  scale_x_date(\n    date_breaks = "month",\n    labels = scales::label_date_short()\n  )\n'})})]}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:n(2073).Z+"",width:"1536",height:"960"})}),"\n",(0,l.jsx)(e.h3,{id:"combining-rolling-aggregations",children:"Combining Rolling Aggregations"}),"\n",(0,l.jsxs)(a.Z,{children:[(0,l.jsxs)(i.Z,{value:"PRQL DuckDB",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-elm",metastring:"showLineNumbers",children:"from tab\nsort this.time\nwindow rows:-15..14 (\n  select {\n    this.time,\n    mean = average close,\n    std = stddev close\n  }\n)\ntake 13..17\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[34]}})]}),(0,l.jsxs)(i.Z,{value:"SQL DuckDB",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"FROM tab\nSELECT\n  time,\n  avg(close) OVER (\n    ORDER BY time\n    ROWS BETWEEN 15 PRECEDING AND 14 FOLLOWING\n  ) AS mean,\n  stddev(close) OVER (\n    ORDER BY time\n    ROWS BETWEEN 15 PRECEDING AND 14 FOLLOWING\n  ) AS std\nORDER BY time\nLIMIT 5 OFFSET 12\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[35]}})]}),(0,l.jsxs)(i.Z,{value:"dplyr R",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'.slide_func <- function(.x, .fn) {\n  slider::slide_vec(.x, .fn, .before = 15, .after = 14, .complete = TRUE)\n}\n\nmean_std <- df |>\n  arrange(time) |>\n  mutate(\n    time,\n    across(\n      close,\n      .fns = list(mean = \\(x) .slide_func(x, mean), std = \\(x) .slide_func(x, sd)),\n      .names = "{.fn}"\n    ),\n    .keep = "none"\n  )\n'})}),(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:"mean_std |>\n  slice(13:17)\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[36]}})]}),(0,l.jsxs)(i.Z,{value:"Python Polars",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'mean_std = lf.sort("time").select(\n    time=pl.col("time"),\n    mean=pl.col("close").rolling_mean(30, center=True),\n    std=pl.col("close").rolling_std(30, center=True),\n)\n'})}),(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"mean_std.head(17).tail(5).collect()\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[37]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[38]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[39]}})]})]}),"\n",(0,l.jsxs)(e.p,{children:["As in ",(0,l.jsx)("a",{href:"#sec-moving-ave",class:"quarto-xref",children:"Section\xa05.1"}),", here too the DuckDB results differ from the others."]}),"\n",(0,l.jsx)(e.p,{children:"Plotting the results of dplyr shows the following."}),"\n",(0,l.jsxs)(s,{class:"code-fold",children:[(0,l.jsx)("summary",{children:"Code"}),(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'library(ggplot2)\n\nmean_std |>\n  ggplot(aes(time)) +\n  geom_ribbon(\n    aes(ymin = mean - std, ymax = mean + std),\n    alpha = 0.3, fill = "blue"\n  ) +\n  geom_line(aes(y = mean), color = "blue") +\n  theme_linedraw() +\n  labs(y = "Close ($)") +\n  scale_x_date(\n    date_breaks = "month",\n    labels = scales::label_date_short()\n  )\n'})})]}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.img,{src:n(7741).Z+"",width:"1536",height:"960"})}),"\n",(0,l.jsx)(e.h2,{id:"timezones",children:"Timezones"}),"\n",(0,l.jsxs)(e.admonition,{type:"important",children:[(0,l.jsx)(e.p,{children:"In DuckDB, the icu DuckDB extension is needed for time zones support. If the DuckDB client that we are using does not contain the extension, we need to install and load it."}),(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"INSTALL 'icu'\n"})}),(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"LOAD 'icu'\n"})})]}),"\n",(0,l.jsxs)(a.Z,{children:[(0,l.jsxs)(i.Z,{value:"PRQL DuckDB",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-elm",metastring:"showLineNumbers",children:'let timezone = tz col -> s"timezone({tz}, {col})"\n\nfrom tab\nderive {\n  time_new = (this.time | timezone "UTC" | timezone "US/Eastern")\n}\nselect !{this.time}\ntake 5\n'})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[40]}})]}),(0,l.jsxs)(i.Z,{value:"SQL DuckDB",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"FROM tab\nSELECT\n  * REPLACE timezone('US/Eastern', timezone('UTC', time)) AS time\nLIMIT 5\n"})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[41]}})]}),(0,l.jsxs)(i.Z,{value:"dplyr R",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'df |>\n  mutate(\n    time = time |>\n      lubridate::force_tz("UTC") |>\n      lubridate::with_tz("US/Eastern")\n  ) |>\n  head(5)\n'})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[42]}})]}),(0,l.jsxs)(i.Z,{value:"Python Polars",children:[(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'(\n    lf.with_columns(\n        pl.col("time")\n        .cast(pl.Datetime)\n        .dt.replace_time_zone("UTC")\n        .dt.convert_time_zone("US/Eastern")\n    )\n    .head(5)\n    .collect()\n)\n'})}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[43]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[44]}}),(0,l.jsx)("div",{dangerouslySetInnerHTML:{__html:o[45]}})]})]}),"\n",(0,l.jsxs)(e.p,{children:["Note that each system may keep time zone information in a different way. Here, the ",(0,l.jsx)(e.code,{children:"time"})," column (and the ",(0,l.jsx)(e.code,{children:"time_new"})," column) in DuckDB results are the TIMESTAMP type, has no time zone information."]}),"\n","\n",(0,l.jsxs)(e.section,{"data-footnotes":!0,className:"footnotes",children:[(0,l.jsx)(e.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsxs)(e.li,{id:"user-content-fn-1",children:["\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.a,{href:"https://duckdb.org/docs/sql/functions/timestamptz#icu-timestamp-with-time-zone-operators",children:"https://duckdb.org/docs/sql/functions/timestamptz#icu-timestamp-with-time-zone-operators"})," ",(0,l.jsx)(e.a,{href:"#user-content-fnref-1","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{id:"user-content-fn-2",children:["\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.a,{href:"https://github.com/tidyverse/lubridate/issues/932",children:"https://github.com/tidyverse/lubridate/issues/932"})," ",(0,l.jsx)(e.a,{href:"#user-content-fnref-2","data-footnote-backref":"","aria-label":"Back to reference 2",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,l.jsxs)(e.li,{id:"user-content-fn-3",children:["\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.a,{href:"https://pola-rs.github.io/polars/py-polars/html/reference/dataframe/api/polars.DataFrame.groupby_dynamic.html",children:"https://pola-rs.github.io/polars/py-polars/html/reference/dataframe/api/polars.DataFrame.groupby_dynamic.html"})," ",(0,l.jsx)(e.a,{href:"#user-content-fnref-3","data-footnote-backref":"","aria-label":"Back to reference 3",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function y(t={}){const{wrapper:e}={...(0,d.a)(),...t.components};return e?(0,l.jsx)(e,{...t,children:(0,l.jsx)(x,{...t})}):x(t)}},5162:(t,e,n)=>{n.d(e,{Z:()=>i});n(7294);var l=n(512);const d={tabItem:"tabItem_Ymn6"};var a=n(5893);function i(t){let{children:e,hidden:n,className:i}=t;return(0,a.jsx)("div",{role:"tabpanel",className:(0,l.Z)(d.tabItem,i),hidden:n,children:e})}},4866:(t,e,n)=>{n.d(e,{Z:()=>_});var l=n(7294),d=n(512),a=n(2466),i=n(6550),s=n(469),r=n(1980),h=n(7392),g=n(812);function o(t){return l.Children.toArray(t).filter((t=>"\n"!==t)).map((t=>{if(!t||(0,l.isValidElement)(t)&&function(t){const{props:e}=t;return!!e&&"object"==typeof e&&"value"in e}(t))return t;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof t.type?t.type:t.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function c(t){const{values:e,children:n}=t;return(0,l.useMemo)((()=>{const t=e??function(t){return o(t).map((t=>{let{props:{value:e,label:n,attributes:l,default:d}}=t;return{value:e,label:n,attributes:l,default:d}}))}(n);return function(t){const e=(0,h.l)(t,((t,e)=>t.value===e.value));if(e.length>0)throw new Error(`Docusaurus error: Duplicate values "${e.map((t=>t.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(t),t}),[e,n])}function x(t){let{value:e,tabValues:n}=t;return n.some((t=>t.value===e))}function y(t){let{queryString:e=!1,groupId:n}=t;const d=(0,i.k6)(),a=function(t){let{queryString:e=!1,groupId:n}=t;if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,r._X)(a),(0,l.useCallback)((t=>{if(!a)return;const e=new URLSearchParams(d.location.search);e.set(a,t),d.replace({...d.location,search:e.toString()})}),[a,d])]}function u(t){const{defaultValue:e,queryString:n=!1,groupId:d}=t,a=c(t),[i,r]=(0,l.useState)((()=>function(t){let{defaultValue:e,tabValues:n}=t;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!x({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((t=>t.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const l=n.find((t=>t.default))??n[0];if(!l)throw new Error("Unexpected error: 0 tabValues");return l.value}({defaultValue:e,tabValues:a}))),[h,o]=y({queryString:n,groupId:d}),[u,m]=function(t){let{groupId:e}=t;const n=function(t){return t?`docusaurus.tab.${t}`:null}(e),[d,a]=(0,g.Nk)(n);return[d,(0,l.useCallback)((t=>{n&&a.set(t)}),[n,a])]}({groupId:d}),f=(()=>{const t=h??u;return x({value:t,tabValues:a})?t:null})();(0,s.Z)((()=>{f&&r(f)}),[f]);return{selectedValue:i,selectValue:(0,l.useCallback)((t=>{if(!x({value:t,tabValues:a}))throw new Error(`Can't select invalid tab value=${t}`);r(t),o(t),m(t)}),[o,m,a]),tabValues:a}}var m=n(2389);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=n(5893);function p(t){let{className:e,block:n,selectedValue:l,selectValue:i,tabValues:s}=t;const r=[],{blockElementScrollPositionUntilNextRender:h}=(0,a.o5)(),g=t=>{const e=t.currentTarget,n=r.indexOf(e),d=s[n].value;d!==l&&(h(e),i(d))},o=t=>{let e=null;switch(t.key){case"Enter":g(t);break;case"ArrowRight":{const n=r.indexOf(t.currentTarget)+1;e=r[n]??r[0];break}case"ArrowLeft":{const n=r.indexOf(t.currentTarget)-1;e=r[n]??r[r.length-1];break}}e?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,d.Z)("tabs",{"tabs--block":n},e),children:s.map((t=>{let{value:e,label:n,attributes:a}=t;return(0,b.jsx)("li",{role:"tab",tabIndex:l===e?0:-1,"aria-selected":l===e,ref:t=>r.push(t),onKeyDown:o,onClick:g,...a,className:(0,d.Z)("tabs__item",f.tabItem,a?.className,{"tabs__item--active":l===e}),children:n??e},e)}))})}function v(t){let{lazy:e,children:n,selectedValue:d}=t;const a=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const t=a.find((t=>t.props.value===d));return t?(0,l.cloneElement)(t,{className:"margin-top--md"}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:a.map(((t,e)=>(0,l.cloneElement)(t,{key:e,hidden:t.props.value!==d})))})}function j(t){const e=u(t);return(0,b.jsxs)("div",{className:(0,d.Z)("tabs-container",f.tabList),children:[(0,b.jsx)(p,{...e,...t}),(0,b.jsx)(v,{...e,...t})]})}function _(t){const e=(0,m.Z)();return(0,b.jsx)(j,{...t,children:o(t.children)},String(e))}},7741:(t,e,n)=>{n.d(e,{Z:()=>l});const l=n.p+"assets/images/plot-rolling-combined-1-61c1f9be1eee948b0223996b8d917657.png"},2073:(t,e,n)=>{n.d(e,{Z:()=>l});const l=n.p+"assets/images/plot-window-functions-1-2697f18fde4fc52327d5c4cbc7aa44fb.png"},1151:(t,e,n)=>{n.d(e,{Z:()=>s,a:()=>i});var l=n(7294);const d={},a=l.createContext(d);function i(t){const e=l.useContext(a);return l.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function s(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(d):t.components||d:i(t.components),l.createElement(a.Provider,{value:e},t.children)}}}]);