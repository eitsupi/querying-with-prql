"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[908],{8287:(t,e,l)=>{l.r(e),l.d(e,{assets:()=>c,contentTitle:()=>h,default:()=>o,frontMatter:()=>d,metadata:()=>x,quartoRawHtml:()=>j,toc:()=>g});var i=l(5893),n=l(1151),s=l(4866),r=l(5162);const d={title:"Timeseries",description:"Handling timeseries data.",engine:"knitr",knitr:{opts_chunk:{connection:"con","engine-opts":{target:"sql.duckdb",use_glue:!0}}},execute:{cache:!0},sidebar_position:5},h=void 0,x={id:"timeseries",title:"Timeseries",description:"Handling timeseries data.",source:"@site/docs/timeseries.mdx",sourceDirName:".",slug:"/timeseries",permalink:"/querying-with-prql/timeseries",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"Timeseries",description:"Handling timeseries data.",engine:"knitr",knitr:{opts_chunk:{connection:"con","engine-opts":{target:"sql.duckdb",use_glue:!0}}},execute:{cache:!0},sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Reshaping and Tidy Data",permalink:"/querying-with-prql/tidy"}},c={},g=[{value:"Preparing Data",id:"preparing-data",level:2},{value:"Download",id:"download",level:3},{value:"Load the Data",id:"load-the-data",level:3},{value:"Filtering",id:"filtering",level:2},{value:"Downsampling",id:"downsampling",level:2},{value:"Upsampling",id:"upsampling",level:2},{value:"Window Functions",id:"window-functions",level:2},{value:"Moving Average, Cumulative Avarage",id:"sec-moving-ave",level:3},{value:"Combining Rolling Aggregations",id:"combining-rolling-aggregations",level:3},{value:"Timezones",id:"timezones",level:2}],j=["<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 6)</small>","</div>","<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 6)</small>","</div>","<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 6)</small>","</div>","<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 11)</small>","</div>","<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 6)</small>","</div>","<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 4)</small>","</div>","<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 3)</small>","</div>","<div><style>\n.dataframe > thead > tr,\n.dataframe > tbody > tr {\n  text-align: right;\n  white-space: pre-wrap;\n}\n</style>\n<small>shape: (5, 6)</small>","</div>"];function a(t){const e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",sup:"sup",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.a)(),...t.components},{Details:d}=e;return d||function(t,e){throw new Error("Expected "+(e?"component":"object")+" `"+t+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.admonition,{type:"note",children:(0,i.jsxs)(e.p,{children:["This page is based on the chapter ",(0,i.jsx)(e.a,{href:"https://kevinheavey.github.io/modern-polars/timeseries.html",children:"\u201cTimeseries\u201d"})," of the Modern Polars book."]})}),"\n",(0,i.jsx)(e.h2,{id:"preparing-data",children:"Preparing Data"}),"\n",(0,i.jsx)(e.admonition,{type:"important",children:(0,i.jsxs)(e.p,{children:["Since the PRQL and SQL results shown on this page are after being converted to R DataFrame via knitr, they have been converted from DuckDB types to R types. So ",(0,i.jsx)(e.code,{children:"NULL"})," in DuckDB is shown as ",(0,i.jsx)(e.code,{children:"NA"}),"."]})}),"\n",(0,i.jsx)(e.h3,{id:"download",children:"Download"}),"\n",(0,i.jsxs)(e.p,{children:["Download the data from ",(0,i.jsx)(e.a,{href:"https://github.com/binance/binance-spot-api-docs/blob/master/rest-api.md",children:"Binance REST API"})," and write it to a Parquet file."]}),"\n",(0,i.jsxs)(e.p,{children:["This document uses R to download the data from the source here, but we can also download and use the Parquet file included in the ",(0,i.jsx)(e.a,{href:"https://github.com/kevinheavey/modern-polars/blob/master/data/ohlcv.pq",children:"kevinheavey/modern-polars"})," GitHub repository."]}),"\n",(0,i.jsxs)(s.Z,{children:[(0,i.jsx)(r.Z,{value:"R",children:(0,i.jsxs)(d,{class:"code-fold",children:[(0,i.jsx)("summary",{children:"Code"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'data_path <- "data/ohlcv.parquet"\n\nif (!fs::file_exists(data_path)) {\n  fs::dir_create(fs::path_dir(data_path))\n\n  .epoch_ms <- function(dt) {\n    dt |>\n      lubridate::as_datetime() |>\n      (\\(x) (as.integer(x) * 1000))()\n  }\n\n  .start <- lubridate::make_datetime(2021, 1, 1) |> .epoch_ms()\n  .end <- lubridate::make_datetime(2022, 1, 1) |> .epoch_ms()\n\n  .url <- glue::glue(\n    "https://api.binance.com/api/v3/klines?symbol=BTCUSDT&",\n    "interval=1d&startTime={.start}&endTime={.end}"\n  )\n\n  .res <- jsonlite::read_json(.url)\n\n  time_col <- "time"\n  ohlcv_cols <- c(\n    "open",\n    "high",\n    "low",\n    "close",\n    "volume"\n  )\n  cols_to_use <- c(time_col, ohlcv_cols)\n  cols <- c(cols_to_use, glue::glue("ignore_{i}", i = 1:6))\n\n  df <- .res |>\n    tibble::enframe(name = NULL) |>\n    tidyr::unnest_wider(value, names_sep = "_") |>\n    rlang::set_names({{ cols }}) |>\n    dplyr::mutate(\n      dplyr::across({{ time_col }}, \\(x) lubridate::as_datetime(x / 1000) |> lubridate::as_date()),\n      dplyr::across({{ ohlcv_cols }}, as.numeric),\n      .keep = "none"\n    )\n\n  # Unlike the Python client, the duckdb R client does not (yet) have automatic DataFrame registration.\n  # (duckdb/duckdb#6771)\n  con_tmp <- DBI::dbConnect(duckdb::duckdb(), ":memory:")\n  duckdb::duckdb_register(con_tmp, "df", df)\n  duckdb:::sql(glue::glue("COPY df TO \'{data_path}\' (FORMAT PARQUET)"), con_tmp)\n  DBI::dbDisconnect(con_tmp)\n}\n'})})]})}),(0,i.jsxs)(r.Z,{value:"Shell",children:[(0,i.jsxs)(e.p,{children:["This is a sample command to download the Parquet file from the ",(0,i.jsx)(e.code,{children:"kevinheavey/modern-polars"})," GitHub repository."]}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",metastring:'showLineNumbers title="Terminal"',children:"mkdir data\ncurl -sL https://github.com/kevinheavey/modern-polars/raw/d67d6f95ce0de8aad5492c4497ac4c3e33d696e8/data/ohlcv.pq -o data/ohlcv.parquet\n"})})]})]}),"\n",(0,i.jsx)(e.h3,{id:"load-the-data",children:"Load the Data"}),"\n",(0,i.jsx)(e.p,{children:"After the Parquet file is ready, load that into DuckDB (in-memory) database table, R DataFrame, and Python polars.LazyFrame."}),"\n",(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)(r.Z,{value:"DuckDB",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"CREATE TABLE tab AS FROM 'data/ohlcv.parquet'\n"})}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"FROM tab\nLIMIT 5\n"})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28923.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29600.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28624.57"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29331.69"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"54182.93"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-02"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29331.70"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33300.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28946.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32178.33"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"129993.87"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-03"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32176.45"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34778.11"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31962.99"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33000.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"120957.57"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-04"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33000.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33600.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28130.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31988.71"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"140899.89"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31989.75"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34360.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29900.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33949.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"116050.00"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"R DataFrame",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:"library(dplyr, warn.conflicts = FALSE)\n\ndf <- duckdb:::sql(\"FROM 'data/ohlcv.parquet'\")\n"})}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:"df |> head(5)\n"})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28923.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29600.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28624.57"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29331.69"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"54182.93"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-02"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29331.70"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33300.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28946.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32178.33"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"129993.87"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-03"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32176.45"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34778.11"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31962.99"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33000.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"120957.57"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-04"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33000.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33600.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28130.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31988.71"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"140899.89"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31989.75"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34360.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29900.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33949.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"116050.00"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"Python polars.LazyFrame",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'import polars as pl\n\nlf = pl.scan_parquet("data/ohlcv.parquet")\n'})}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"lf.fetch(5)\n"})}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[0]}}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"time"}),(0,i.jsx)(e.th,{children:"open"}),(0,i.jsx)(e.th,{children:"high"}),(0,i.jsx)(e.th,{children:"low"}),(0,i.jsx)(e.th,{children:"close"}),(0,i.jsx)(e.th,{children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"date"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-01"}),(0,i.jsx)(e.td,{children:"28923.63"}),(0,i.jsx)(e.td,{children:"29600.0"}),(0,i.jsx)(e.td,{children:"28624.57"}),(0,i.jsx)(e.td,{children:"29331.69"}),(0,i.jsx)(e.td,{children:"54182.925011"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-02"}),(0,i.jsx)(e.td,{children:"29331.7"}),(0,i.jsx)(e.td,{children:"33300.0"}),(0,i.jsx)(e.td,{children:"28946.53"}),(0,i.jsx)(e.td,{children:"32178.33"}),(0,i.jsx)(e.td,{children:"129993.873362"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-03"}),(0,i.jsx)(e.td,{children:"32176.45"}),(0,i.jsx)(e.td,{children:"34778.11"}),(0,i.jsx)(e.td,{children:"31962.99"}),(0,i.jsx)(e.td,{children:"33000.05"}),(0,i.jsx)(e.td,{children:"120957.56675"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-04"}),(0,i.jsx)(e.td,{children:"33000.05"}),(0,i.jsx)(e.td,{children:"33600.0"}),(0,i.jsx)(e.td,{children:"28130.0"}),(0,i.jsx)(e.td,{children:"31988.71"}),(0,i.jsx)(e.td,{children:"140899.88569"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-05"}),(0,i.jsx)(e.td,{children:"31989.75"}),(0,i.jsx)(e.td,{children:"34360.0"}),(0,i.jsx)(e.td,{children:"29900.0"}),(0,i.jsx)(e.td,{children:"33949.53"}),(0,i.jsx)(e.td,{children:"116049.997038"})]})]})]}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[1]}})]})]}),"\n",(0,i.jsx)(e.h2,{id:"filtering",children:"Filtering"}),"\n",(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)(r.Z,{value:"PRQL DuckDB",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-elm",metastring:"showLineNumbers",children:"from tab\nfilter s\"date_part(['year', 'month'], time) = {{year: 2021, month: 2}}\"\ntake 5\n"})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-01"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33092.97"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34717.27"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32296.16"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33526.37"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"82718.28"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-02"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33517.09"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35984.33"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33418.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35466.24"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"78056.66"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-03"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35472.71"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37662.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35362.38"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37618.87"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"80784.33"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-04"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37620.26"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38708.27"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36161.95"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36936.66"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"92080.74"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36936.65"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38310.12"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36570.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38290.24"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"66681.33"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"SQL DuckDB",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"FROM tab\nWHERE date_part(['year', 'month'], time) = {year: 2021, month: 2}\nLIMIT 5\n"})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-01"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33092.97"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34717.27"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32296.16"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33526.37"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"82718.28"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-02"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33517.09"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35984.33"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33418.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35466.24"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"78056.66"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-03"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35472.71"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37662.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35362.38"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37618.87"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"80784.33"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-04"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37620.26"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38708.27"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36161.95"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36936.66"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"92080.74"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36936.65"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38310.12"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36570.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38290.24"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"66681.33"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"dplyr R",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'df |>\n  filter(\n    lubridate::floor_date(time, "month") == lubridate::make_datetime(2021, 2)\n  ) |>\n  head(5)\n'})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-01"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33092.97"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34717.27"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32296.16"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33526.37"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"82718.28"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-02"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33517.09"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35984.33"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33418.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35466.24"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"78056.66"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-03"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35472.71"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37662.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35362.38"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37618.87"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"80784.33"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-04"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37620.26"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38708.27"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36161.95"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36936.66"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"92080.74"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-02-05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36936.65"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38310.12"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36570.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38290.24"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"66681.33"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"Python Polars",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'(\n    lf.filter((pl.col("time").dt.year() == 2021) & (pl.col("time").dt.month() == 2))\n    .head(5)\n    .collect()\n)\n'})}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[2]}}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"time"}),(0,i.jsx)(e.th,{children:"open"}),(0,i.jsx)(e.th,{children:"high"}),(0,i.jsx)(e.th,{children:"low"}),(0,i.jsx)(e.th,{children:"close"}),(0,i.jsx)(e.th,{children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"date"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-02-01"}),(0,i.jsx)(e.td,{children:"33092.97"}),(0,i.jsx)(e.td,{children:"34717.27"}),(0,i.jsx)(e.td,{children:"32296.16"}),(0,i.jsx)(e.td,{children:"33526.37"}),(0,i.jsx)(e.td,{children:"82718.276882"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-02-02"}),(0,i.jsx)(e.td,{children:"33517.09"}),(0,i.jsx)(e.td,{children:"35984.33"}),(0,i.jsx)(e.td,{children:"33418.0"}),(0,i.jsx)(e.td,{children:"35466.24"}),(0,i.jsx)(e.td,{children:"78056.65988"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-02-03"}),(0,i.jsx)(e.td,{children:"35472.71"}),(0,i.jsx)(e.td,{children:"37662.63"}),(0,i.jsx)(e.td,{children:"35362.38"}),(0,i.jsx)(e.td,{children:"37618.87"}),(0,i.jsx)(e.td,{children:"80784.333663"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-02-04"}),(0,i.jsx)(e.td,{children:"37620.26"}),(0,i.jsx)(e.td,{children:"38708.27"}),(0,i.jsx)(e.td,{children:"36161.95"}),(0,i.jsx)(e.td,{children:"36936.66"}),(0,i.jsx)(e.td,{children:"92080.735898"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-02-05"}),(0,i.jsx)(e.td,{children:"36936.65"}),(0,i.jsx)(e.td,{children:"38310.12"}),(0,i.jsx)(e.td,{children:"36570.0"}),(0,i.jsx)(e.td,{children:"38290.24"}),(0,i.jsx)(e.td,{children:"66681.334275"})]})]})]}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[3]}})]})]}),"\n",(0,i.jsx)(e.h2,{id:"downsampling",children:"Downsampling"}),"\n",(0,i.jsxs)(e.p,{children:["It is important to note carefully how units such as ",(0,i.jsx)(e.code,{children:"5 days"})," or ",(0,i.jsx)(e.code,{children:"1 week"})," actually work. In other words, where to start counting ",(0,i.jsx)(e.code,{children:"5 days"})," or ",(0,i.jsx)(e.code,{children:"1 week"})," could be completely different in each system."]}),"\n",(0,i.jsxs)(e.p,{children:["Here, we should note that ",(0,i.jsx)(e.code,{children:"time_bucket"})," in DuckDB, ",(0,i.jsx)(e.code,{children:"lubridate::floor_date"})," in R, and ",(0,i.jsx)(e.code,{children:"groupby_dynamic"})," in Polars have completely different initial starting points by default."]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["The DuckDB function ",(0,i.jsx)(e.code,{children:"time_bucket"}),"\u2019s origin defaults to ",(0,i.jsx)(e.code,{children:"2000-01-03 00:00:00+00"})," for days or weeks interval.",(0,i.jsx)(e.sup,{children:(0,i.jsx)(e.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:["In the R ",(0,i.jsx)(e.code,{children:"lubridate::floor_date"})," function, timestamp is floored using the number of days elapsed since the beginning of every month when specifying ",(0,i.jsx)(e.code,{children:'"5 days"'})," to the ",(0,i.jsx)(e.code,{children:"unit"})," argument."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'lubridate::as_date(c("2023-01-31", "2023-02-01")) |>\n  lubridate::floor_date("5 days")\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-text",children:'[1] "2023-01-31" "2023-02-01"\n'})}),"\n",(0,i.jsxs)(e.p,{children:["And when ",(0,i.jsx)(e.code,{children:'"1 week"'})," to the ",(0,i.jsx)(e.code,{children:"unit"})," argument, it is floored to the nearest week, Sunday through Saturday."]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'lubridate::as_date(c("2023-01-31", "2023-02-01")) |>\n  lubridate::floor_date("1 week")\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-text",children:'[1] "2023-01-29" "2023-01-29"\n'})}),"\n",(0,i.jsxs)(e.p,{children:["To start from an arbitrary origin, all breaks must be specified as a vector in the unit argument.",(0,i.jsx)(e.sup,{children:(0,i.jsx)(e.a,{href:"#user-content-fn-2",id:"user-content-fnref-2","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'lubridate::as_date(c("2023-01-31", "2023-02-01")) |>\n  lubridate::floor_date(lubridate::make_date(2023, 1, 31))\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-text",children:'[1] "2023-01-31" "2023-01-31"\n'})}),"\n"]}),"\n",(0,i.jsxs)(e.li,{children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.code,{children:"groupby_dynamic"})," of Polars, the ",(0,i.jsx)(e.code,{children:"offset"})," parameter to specify the origin point, is negative ",(0,i.jsx)(e.code,{children:"every"})," by default.",(0,i.jsx)(e.sup,{children:(0,i.jsx)(e.a,{href:"#user-content-fn-3",id:"user-content-fnref-3","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"3"})})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)(r.Z,{value:"PRQL DuckDB",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-elm",metastring:"showLineNumbers",children:'from tab\nderive {\n  time_new = s"""\n    time_bucket(INTERVAL \'5 days\', time, (FROM tab SELECT min(time)))\n  """\n}\ngroup {time_new} (\n  aggregate {\n    open = average open,\n    high = average high,\n    low = average low,\n    close = average close,\n    volume = average volume\n  }\n)\nsort time_new\ntake 5\n'})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time_new"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31084.32"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33127.62"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29512.82"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32089.66"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"112416.85"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-06"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38165.31"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"40396.84"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35983.82"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"39004.54"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"118750.08"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-11"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36825.23"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38518.10"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33288.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36542.76"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"146166.70"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-16"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36216.36"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37307.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34650.37"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35962.92"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"81236.80"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-21"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32721.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34165.71"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"30624.23"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32077.48"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"97809.66"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"SQL DuckDB",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"WITH _tab1 AS (\n  FROM tab\n  SELECT\n    * REPLACE (time_bucket(INTERVAL '5 days', time, (FROM tab SELECT min(time)))) AS time\n)\n\nFROM _tab1\nSELECT\n  time,\n  avg(COLUMNS(x -> x NOT IN ('time')))\nGROUP BY time\nORDER BY time\nLIMIT 5\n"})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"avg(_tab1.open)"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"avg(_tab1.high)"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"avg(_tab1.low)"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"avg(_tab1.\u201dclose\u201d)"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"avg(_tab1.volume)"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31084.32"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33127.62"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29512.82"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32089.66"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"112416.85"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-06"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38165.31"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"40396.84"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35983.82"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"39004.54"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"118750.08"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-11"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36825.23"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38518.10"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33288.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36542.76"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"146166.70"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-16"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36216.36"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37307.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34650.37"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35962.92"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"81236.80"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-21"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32721.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34165.71"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"30624.23"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32077.48"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"97809.66"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"dplyr R",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:"df |>\n  mutate(\n    time = time |>\n      (\\(x) lubridate::floor_date(x, seq(min(x), max(x), by = 5)))()\n  ) |>\n  summarise(across(everything(), mean), .by = time) |>\n  head(5)\n"})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31084.32"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33127.62"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29512.82"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32089.66"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"112416.85"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-06"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38165.31"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"40396.84"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35983.82"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"39004.54"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"118750.08"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-11"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36825.23"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"38518.10"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33288.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36542.76"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"146166.70"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-16"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36216.36"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37307.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34650.37"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35962.92"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"81236.80"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-21"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32721.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34165.71"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"30624.23"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32077.48"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"97809.66"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"Python Polars",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'(\n    lf.sort("time")\n    .groupby_dynamic("time", every="5d")\n    .agg(pl.col(pl.Float64).mean())\n    .head(5)\n    .collect()\n)\n'})}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[4]}}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"time"}),(0,i.jsx)(e.th,{children:"open"}),(0,i.jsx)(e.th,{children:"high"}),(0,i.jsx)(e.th,{children:"low"}),(0,i.jsx)(e.th,{children:"close"}),(0,i.jsx)(e.th,{children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"date"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2020-12-29"}),(0,i.jsx)(e.td,{children:"29127.665"}),(0,i.jsx)(e.td,{children:"31450.0"}),(0,i.jsx)(e.td,{children:"28785.55"}),(0,i.jsx)(e.td,{children:"30755.01"}),(0,i.jsx)(e.td,{children:"92088.399186"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-03"}),(0,i.jsx)(e.td,{children:"33577.028"}),(0,i.jsx)(e.td,{children:"36008.464"}),(0,i.jsx)(e.td,{children:"31916.198"}),(0,i.jsx)(e.td,{children:"35027.986"}),(0,i.jsx)(e.td,{children:"127574.470245"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-08"}),(0,i.jsx)(e.td,{children:"38733.61"}),(0,i.jsx)(e.td,{children:"39914.548"}),(0,i.jsx)(e.td,{children:"34656.422"}),(0,i.jsx)(e.td,{children:"37655.352"}),(0,i.jsx)(e.td,{children:"143777.954392"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-13"}),(0,i.jsx)(e.td,{children:"36659.63"}),(0,i.jsx)(e.td,{children:"38500.052"}),(0,i.jsx)(e.td,{children:"34539.406"}),(0,i.jsx)(e.td,{children:"37016.338"}),(0,i.jsx)(e.td,{children:"102447.076833"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-18"}),(0,i.jsx)(e.td,{children:"34933.922"}),(0,i.jsx)(e.td,{children:"36232.334"}),(0,i.jsx)(e.td,{children:"32593.012"}),(0,i.jsx)(e.td,{children:"34357.258"}),(0,i.jsx)(e.td,{children:"103530.722029"})]})]})]}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[5]}})]})]}),"\n",(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)(r.Z,{value:"PRQL DuckDB",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-elm",metastring:"showLineNumbers",children:'from tab\nderive {\n  time_new = s"""\n    time_bucket(INTERVAL \'7 days\', time, (FROM tab SELECT min(time)))\n  """\n}\ngroup {time_new} (\n  aggregate {\n    open_mean = average open,\n    high_mean = average high,\n    low_mean = average low,\n    close_mean = average close,\n    volume_mean = average volume,\n    open_sum = sum open,\n    high_sum = sum high,\n    low_sum = sum low,\n    close_sum = sum close,\n    volume_sum = sum volume\n  }\n)\nsort time_new\ntake 5\n'})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time_new"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open_mean"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high_mean"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low_mean"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close_mean"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume_mean"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open_sum"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high_sum"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low_sum"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close_sum"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume_sum"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32305.78"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34706.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31021.73"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33807.14"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"117435.59"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"226140.5"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"242942.3"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"217152.1"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"236650.0"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"822049.1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-08"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37869.80"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"39646.11"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34623.33"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37827.52"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"135188.30"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"265088.6"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"277522.7"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"242363.3"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"264792.6"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"946318.1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-15"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36527.89"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37412.20"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33961.55"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35343.85"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"94212.72"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"255695.2"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"261885.4"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"237730.9"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"247406.9"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"659489.0"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-22"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31888.55"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33498.81"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"30424.48"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32248.01"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"89649.94"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"223219.8"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"234491.7"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"212971.4"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"225736.0"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"627549.6"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-29"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34511.48"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36411.44"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33450.08"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35022.31"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"102728.42"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"241580.4"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"254880.1"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"234150.6"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"245156.2"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"719099.0"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"SQL DukcDB",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"WITH _tab1 AS (\n  FROM tab\n  SELECT\n    * REPLACE (time_bucket(INTERVAL '7 days', time, (FROM tab SELECT min(time)))) AS time\n)\n\nFROM _tab1\nSELECT\n  time,\n  avg(COLUMNS(x -> x NOT IN ('time'))),\n  sum(COLUMNS(x -> x NOT IN ('time')))\nGROUP BY time\nORDER BY time\nLIMIT 5\n"})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"avg(_tab1.open)"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"avg(_tab1.high)"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"avg(_tab1.low)"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"avg(_tab1.\u201dclose\u201d)"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"avg(_tab1.volume)"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"sum(_tab1.open)"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"sum(_tab1.high)"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"sum(_tab1.low)"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"sum(_tab1.\u201dclose\u201d)"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"sum(_tab1.volume)"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32305.78"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34706.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31021.73"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33807.14"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"117435.59"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"226140.5"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"242942.3"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"217152.1"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"236650.0"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"822049.1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-08"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37869.80"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"39646.11"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34623.33"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37827.52"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"135188.30"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"265088.6"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"277522.7"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"242363.3"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"264792.6"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"946318.1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-15"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36527.89"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37412.20"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33961.55"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35343.85"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"94212.72"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"255695.2"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"261885.4"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"237730.9"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"247406.9"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"659489.0"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-22"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31888.55"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33498.81"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"30424.48"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32248.01"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"89649.94"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"223219.8"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"234491.7"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"212971.4"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"225736.0"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"627549.6"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-29"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34511.48"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36411.44"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33450.08"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35022.31"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"102728.42"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"241580.4"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"254880.1"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"234150.6"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"245156.2"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"719099.0"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"dplyr R",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'df |>\n  mutate(\n    time = time |>\n      (\\(x) lubridate::floor_date(x, seq(min(x), max(x), by = 7)))()\n  ) |>\n  summarise(\n    across(\n      everything(),\n      list(mean = mean, sum = sum),\n      .names = "{.col}_{.fn}"\n    ),\n    .by = time\n  ) |>\n  head(5)\n'})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open_mean"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open_sum"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high_mean"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high_sum"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low_mean"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low_sum"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close_mean"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close_sum"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume_mean"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume_sum"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32305.78"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"226140.5"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34706.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"242942.3"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31021.73"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"217152.1"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33807.14"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"236650.0"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"117435.59"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"822049.1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-08"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37869.80"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"265088.6"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"39646.11"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"277522.7"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34623.33"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"242363.3"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37827.52"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"264792.6"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"135188.30"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"946318.1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-15"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36527.89"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"255695.2"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"37412.20"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"261885.4"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33961.55"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"237730.9"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35343.85"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"247406.9"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"94212.72"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"659489.0"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-22"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31888.55"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"223219.8"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33498.81"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"234491.7"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"30424.48"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"212971.4"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32248.01"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"225736.0"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"89649.94"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"627549.6"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-29"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34511.48"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"241580.4"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"36411.44"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"254880.1"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33450.08"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"234150.6"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35022.31"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"245156.2"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"102728.42"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"719099.0"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"Python Polars",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'(\n    lf.sort("time")\n    .groupby_dynamic("time", every="1w")\n    .agg(\n        [\n            pl.col(pl.Float64).mean().suffix("_mean"),\n            pl.col(pl.Float64).sum().suffix("_sum"),\n        ]\n    )\n    .head(5)\n    .collect()\n)\n'})}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[6]}}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"time"}),(0,i.jsx)(e.th,{children:"open_mean"}),(0,i.jsx)(e.th,{children:"high_mean"}),(0,i.jsx)(e.th,{children:"low_mean"}),(0,i.jsx)(e.th,{children:"close_mean"}),(0,i.jsx)(e.th,{children:"volume_mean"}),(0,i.jsx)(e.th,{children:"open_sum"}),(0,i.jsx)(e.th,{children:"high_sum"}),(0,i.jsx)(e.th,{children:"low_sum"}),(0,i.jsx)(e.th,{children:"close_sum"}),(0,i.jsx)(e.th,{children:"volume_sum"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"date"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2020-12-28"}),(0,i.jsx)(e.td,{children:"30143.926667"}),(0,i.jsx)(e.td,{children:"32559.37"}),(0,i.jsx)(e.td,{children:"29844.696667"}),(0,i.jsx)(e.td,{children:"31503.356667"}),(0,i.jsx)(e.td,{children:"101711.455041"}),(0,i.jsx)(e.td,{children:"90431.78"}),(0,i.jsx)(e.td,{children:"97678.11"}),(0,i.jsx)(e.td,{children:"89534.09"}),(0,i.jsx)(e.td,{children:"94510.07"}),(0,i.jsx)(e.td,{children:"305134.365123"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-04"}),(0,i.jsx)(e.td,{children:"36545.192857"}),(0,i.jsx)(e.td,{children:"38563.458571"}),(0,i.jsx)(e.td,{children:"33992.73"}),(0,i.jsx)(e.td,{children:"37280.132857"}),(0,i.jsx)(e.td,{children:"121528.60945"}),(0,i.jsx)(e.td,{children:"255816.35"}),(0,i.jsx)(e.td,{children:"269944.21"}),(0,i.jsx)(e.td,{children:"237949.11"}),(0,i.jsx)(e.td,{children:"260960.93"}),(0,i.jsx)(e.td,{children:"850700.266152"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-11"}),(0,i.jsx)(e.td,{children:"36694.077143"}),(0,i.jsx)(e.td,{children:"38199.0"}),(0,i.jsx)(e.td,{children:"33664.004286"}),(0,i.jsx)(e.td,{children:"36362.485714"}),(0,i.jsx)(e.td,{children:"128191.382064"}),(0,i.jsx)(e.td,{children:"256858.54"}),(0,i.jsx)(e.td,{children:"267393.0"}),(0,i.jsx)(e.td,{children:"235648.03"}),(0,i.jsx)(e.td,{children:"254537.4"}),(0,i.jsx)(e.td,{children:"897339.67445"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-18"}),(0,i.jsx)(e.td,{children:"34242.515714"}),(0,i.jsx)(e.td,{children:"35384.095714"}),(0,i.jsx)(e.td,{children:"32179.317143"}),(0,i.jsx)(e.td,{children:"33732.027143"}),(0,i.jsx)(e.td,{children:"91460.990826"}),(0,i.jsx)(e.td,{children:"239697.61"}),(0,i.jsx)(e.td,{children:"247688.67"}),(0,i.jsx)(e.td,{children:"225255.22"}),(0,i.jsx)(e.td,{children:"236124.19"}),(0,i.jsx)(e.td,{children:"640226.935785"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-25"}),(0,i.jsx)(e.td,{children:"32745.312857"}),(0,i.jsx)(e.td,{children:"34563.677143"}),(0,i.jsx)(e.td,{children:"31249.037143"}),(0,i.jsx)(e.td,{children:"32865.862857"}),(0,i.jsx)(e.td,{children:"106780.501216"}),(0,i.jsx)(e.td,{children:"229217.19"}),(0,i.jsx)(e.td,{children:"241945.74"}),(0,i.jsx)(e.td,{children:"218743.26"}),(0,i.jsx)(e.td,{children:"230061.04"}),(0,i.jsx)(e.td,{children:"747463.508509"})]})]})]}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[7]}})]})]}),"\n",(0,i.jsx)(e.h2,{id:"upsampling",children:"Upsampling"}),"\n",(0,i.jsxs)(e.p,{children:["The way to use a function like ",(0,i.jsx)(e.code,{children:"generate_series"})," to generate sequential values and then join them is general-purpose."]}),"\n",(0,i.jsxs)(e.p,{children:["In R, we can also use dedicated functions like ",(0,i.jsx)(e.a,{href:"https://business-science.github.io/timetk/reference/pad_by_time.html",children:(0,i.jsx)(e.code,{children:"timetk::pad_by_time"})}),"."]}),"\n",(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)(r.Z,{value:"PRQL DuckDB",children:[(0,i.jsx)(e.admonition,{type:"important",children:(0,i.jsxs)(e.p,{children:["This example does not work with prql-compiler 0.11.1. (",(0,i.jsx)(e.a,{href:"https://github.com/PRQL/prql/issues/3129",children:"PRQL/prql#3129"}),")"]})}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-prql",metastring:"showLineNumbers",children:'let _tab1 = s"""\n  SELECT\n    generate_series(\n      (SELECT min(time)),\n      (SELECT max(time)),\n      INTERVAL \'6 hours\'\n    ).unnest() AS time\n  FROM tab\n"""\n\nfrom _tab1\njoin side:left tab (==time)\nsort tab.time\nselect !{tab.time}\ntake 5\n'})})]}),(0,i.jsxs)(r.Z,{value:"SQL DuckDB",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"WITH _tab1 AS (\n  SELECT\n    generate_series(\n      (FROM tab SELECT min(time)),\n      (FROM tab SELECT max(time)),\n      INTERVAL '6 hours'\n    ).unnest() AS time\n)\n\nFROM _tab1\nLEFT JOIN tab USING (time)\nORDER BY time\nLIMIT 5\n"})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01 00:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28923.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29600"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28624.57"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29331.69"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"54182.93"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01 06:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01 12:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01 18:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-02 00:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29331.70"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33300"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28946.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32178.33"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"129993.87"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"dplyr R",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'.grid <- df$time |>\n  lubridate::as_datetime() |>\n  (\\(x) seq(min(x), max(x), by = "6 hours"))() |>\n  tibble::tibble(time = _)\n\n.grid |>\n  left_join(df, by = "time") |>\n  head(5)\n'})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01 00:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28923.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29600"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28624.57"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29331.69"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"54182.93"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01 06:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01 12:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01 18:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-02 00:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29331.70"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33300"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28946.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32178.33"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"129993.87"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"Python Polars",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'lf.collect().sort("time").upsample("time", every="6h").head(5)\n'})}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[8]}}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"time"}),(0,i.jsx)(e.th,{children:"open"}),(0,i.jsx)(e.th,{children:"high"}),(0,i.jsx)(e.th,{children:"low"}),(0,i.jsx)(e.th,{children:"close"}),(0,i.jsx)(e.th,{children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"date"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-01"}),(0,i.jsx)(e.td,{children:"28923.63"}),(0,i.jsx)(e.td,{children:"29600.0"}),(0,i.jsx)(e.td,{children:"28624.57"}),(0,i.jsx)(e.td,{children:"29331.69"}),(0,i.jsx)(e.td,{children:"54182.925011"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-01"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-01"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-01"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-02"}),(0,i.jsx)(e.td,{children:"29331.7"}),(0,i.jsx)(e.td,{children:"33300.0"}),(0,i.jsx)(e.td,{children:"28946.53"}),(0,i.jsx)(e.td,{children:"32178.33"}),(0,i.jsx)(e.td,{children:"129993.873362"})]})]})]}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[9]}})]})]}),"\n",(0,i.jsx)(e.h2,{id:"window-functions",children:"Window Functions"}),"\n",(0,i.jsx)(e.p,{children:"It is necessary to be careful how the Window function calculates if the width of the window is less than the specified value."}),"\n",(0,i.jsx)(e.h3,{id:"sec-moving-ave",children:"Moving Average, Cumulative Avarage"}),"\n",(0,i.jsx)(e.p,{children:"PRQL has a dedicated way of applying the window to the entire table. For the others, use a individual function for each column."}),"\n",(0,i.jsxs)(e.p,{children:["In R, base R have some window functions like ",(0,i.jsx)(e.code,{children:"cumsum"}),", but none like cumulative avarage. dplyr complements this with several functions, including ",(0,i.jsx)(e.code,{children:"cummean"}),"."]}),"\n",(0,i.jsx)(e.p,{children:"Polars does not yet have a dedicated function to compute cumulative averages, so we must use cumulative sums to compute them."}),"\n",(0,i.jsx)(e.admonition,{type:"note",children:(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.a,{href:"https://tomaugspurger.github.io/posts/modern-7-timeseries/#rolling--expanding--ew",children:"The original Modern Pandas post"})," and ",(0,i.jsx)(e.a,{href:"https://kevinheavey.github.io/modern-polars/timeseries.html#rolling-expanding-ew",children:"the Modern Polars book"})," have a exponentially weighted (EW) calculation example in addition. But DuckDB does not have a dedicated function to do this, so it is omitted here."]})}),"\n",(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)(r.Z,{value:"PRQL DuckDB",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-elm",metastring:"showLineNumbers",children:"from tab\nsort this.time\nwindow rolling:28 (\n  derive {`28D MA` = average close}\n)\nwindow rows:..0 (\n  derive {`Expanding Average` = average close}\n)\nselect {\n  this.time,\n  Raw = close,\n  `28D MA`,\n  `Expanding Average`\n}\ntake 26..30\n"})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"Raw"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"28D MA"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"Expanding Average"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-26"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32467.77"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35032.87"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35032.87"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-27"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"30366.15"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34860.03"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34860.03"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-28"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33364.86"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34806.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34806.63"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-29"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34252.20"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34982.36"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34787.51"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-30"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34262.88"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35056.81"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34770.02"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"SQL DuckDB",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:'FROM tab\nSELECT\n  time,\n  close AS "Raw",\n  avg(close) OVER (\n    ORDER BY time\n    ROWS BETWEEN 27 PRECEDING AND CURRENT ROW\n  ) AS "28D MA",\n  avg(close) OVER (\n    ORDER BY time\n    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n  ) AS "Expanding Average"\nLIMIT 5 OFFSET 25\n'})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"Raw"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"28D MA"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"Expanding Average"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-26"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32467.77"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35032.87"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35032.87"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-27"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"30366.15"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34860.03"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34860.03"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-28"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33364.86"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34806.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34806.63"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-29"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34252.20"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34982.36"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34787.51"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-30"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34262.88"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35056.81"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34770.02"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"dplyr R",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'roll_and_expand <- df |>\n  arrange(time) |>\n  mutate(\n    time,\n    Raw = close,\n    `28D MA` = close |>\n      slider::slide_vec(mean, .before = 27, .complete = TRUE),\n    `Expanding Average` = cummean(close),\n    .keep = "none"\n  )\n'})}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:"roll_and_expand |>\n  slice(26:30)\n"})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"Raw"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"28D MA"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"Expanding Average"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-26"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32467.77"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35032.87"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-27"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"30366.15"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34860.03"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-28"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33364.86"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34806.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34806.63"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-29"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34252.20"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34982.36"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34787.51"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-30"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34262.88"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"35056.81"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34770.02"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"Python Polars",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'close = pl.col("close")\n\nroll_and_expand = lf.sort("time").select(\n    [\n        pl.col("time"),\n        close.alias("Raw"),\n        close.rolling_mean(28).alias("28D MA"),\n        close.alias("Expanding Average").cum_sum() / (close.cum_count() + 1),\n    ]\n)\n'})}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"roll_and_expand.head(30).tail(5).collect()\n"})}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[10]}}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"time"}),(0,i.jsx)(e.th,{children:"Raw"}),(0,i.jsx)(e.th,{children:"28D MA"}),(0,i.jsx)(e.th,{children:"Expanding Average"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"date"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-26"}),(0,i.jsx)(e.td,{children:"32467.77"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"33735.354074"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-27"}),(0,i.jsx)(e.td,{children:"30366.15"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"33615.025357"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-28"}),(0,i.jsx)(e.td,{children:"33364.86"}),(0,i.jsx)(e.td,{children:"34806.6275"}),(0,i.jsx)(e.td,{children:"33606.398966"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-29"}),(0,i.jsx)(e.td,{children:"34252.2"}),(0,i.jsx)(e.td,{children:"34982.36"}),(0,i.jsx)(e.td,{children:"33627.925667"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-30"}),(0,i.jsx)(e.td,{children:"34262.88"}),(0,i.jsx)(e.td,{children:"35056.808214"}),(0,i.jsx)(e.td,{children:"33648.408065"})]})]})]}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[11]}})]})]}),"\n",(0,i.jsxs)(e.p,{children:["Here, DuckDB also calculates avarage for cases where the window width is less than 28 for the ",(0,i.jsx)(e.code,{children:"28D MA"})," column, whereas R ",(0,i.jsx)(e.code,{children:"slider::slide_vec(.complete = TRUE)"})," and Polars ",(0,i.jsx)(e.code,{children:"rolling_mean"})," make them missing values. If we are using DuckDB and need to make replacement for ",(0,i.jsx)(e.code,{children:"NULL"}),", we need to add further processing."]}),"\n",(0,i.jsx)(e.p,{children:"Plotting the results of dplyr shows the following."}),"\n",(0,i.jsxs)(d,{class:"code-fold",children:[(0,i.jsx)("summary",{children:"Code"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'library(ggplot2)\n\nroll_and_expand |>\n  tidyr::pivot_longer(cols = !time) |>\n  ggplot(aes(time, value, colour = name)) +\n  geom_line() +\n  theme_linedraw() +\n  labs(y = "Close ($)") +\n  scale_x_date(\n    date_breaks = "month",\n    labels = scales::label_date_short()\n  )\n'})})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:l(2073).Z+"",width:"1536",height:"960"})}),"\n",(0,i.jsx)(e.h3,{id:"combining-rolling-aggregations",children:"Combining Rolling Aggregations"}),"\n",(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)(r.Z,{value:"PRQL DuckDB",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-elm",metastring:"showLineNumbers",children:"from tab\nsort this.time\nwindow rows:-15..14 (\n  select {\n    this.time,\n    mean = average close,\n    std = stddev close\n  }\n)\ntake 13..17\n"})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"mean"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"std"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-13"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34860.03"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"3092.516"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-14"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34806.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"3047.833"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-15"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34787.51"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"2994.683"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-16"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34770.02"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"2944.156"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-17"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34895.40"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"2780.095"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"SQL DuckDB",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"FROM tab\nSELECT\n  time,\n  avg(close) OVER (\n    ORDER BY time\n    ROWS BETWEEN 15 PRECEDING AND 14 FOLLOWING\n  ) AS mean,\n  stddev(close) OVER (\n    ORDER BY time\n    ROWS BETWEEN 15 PRECEDING AND 14 FOLLOWING\n  ) AS std\nORDER BY time\nLIMIT 5 OFFSET 12\n"})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"mean"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"std"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-13"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34860.03"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"3092.516"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-14"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34806.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"3047.833"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-15"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34787.51"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"2994.683"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-16"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34770.02"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"2944.156"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-17"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34895.40"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"2780.095"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"dplyr R",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'.slide_func <- function(.x, .fn) {\n  slider::slide_vec(.x, .fn, .before = 15, .after = 14, .complete = TRUE)\n}\n\nmean_std <- df |>\n  arrange(time) |>\n  mutate(\n    time,\n    across(\n      close,\n      .fns = list(mean = \\(x) .slide_func(x, mean), std = \\(x) .slide_func(x, sd)),\n      .names = "{.fn}"\n    ),\n    .keep = "none"\n  )\n'})}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:"mean_std |>\n  slice(13:17)\n"})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"mean"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"std"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-13"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-14"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-15"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"NA"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-16"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34770.02"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"2944.156"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-17"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34895.40"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"2780.095"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"Python Polars",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'mean_std = lf.sort("time").select(\n    time=pl.col("time"),\n    mean=pl.col("close").rolling_mean(30, center=True),\n    std=pl.col("close").rolling_std(30, center=True),\n)\n'})}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"mean_std.head(17).tail(5).collect()\n"})}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[12]}}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"time"}),(0,i.jsx)(e.th,{children:"mean"}),(0,i.jsx)(e.th,{children:"std"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"date"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-13"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-14"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-15"}),(0,i.jsx)(e.td,{children:"null"}),(0,i.jsx)(e.td,{children:"null"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-16"}),(0,i.jsx)(e.td,{children:"34770.021667"}),(0,i.jsx)(e.td,{children:"2944.155675"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-17"}),(0,i.jsx)(e.td,{children:"34895.398"}),(0,i.jsx)(e.td,{children:"2780.095304"})]})]})]}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[13]}})]})]}),"\n",(0,i.jsxs)(e.p,{children:["As in ",(0,i.jsx)("a",{href:"#sec-moving-ave",class:"quarto-xref",children:"Section\xa05.1"}),", here too the DuckDB results differ from the others."]}),"\n",(0,i.jsx)(e.p,{children:"Plotting the results of dplyr shows the following."}),"\n",(0,i.jsxs)(d,{class:"code-fold",children:[(0,i.jsx)("summary",{children:"Code"}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'library(ggplot2)\n\nmean_std |>\n  ggplot(aes(time)) +\n  geom_ribbon(\n    aes(ymin = mean - std, ymax = mean + std),\n    alpha = 0.3, fill = "blue"\n  ) +\n  geom_line(aes(y = mean), color = "blue") +\n  theme_linedraw() +\n  labs(y = "Close ($)") +\n  scale_x_date(\n    date_breaks = "month",\n    labels = scales::label_date_short()\n  )\n'})})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.img,{src:l(7741).Z+"",width:"1536",height:"960"})}),"\n",(0,i.jsx)(e.h2,{id:"timezones",children:"Timezones"}),"\n",(0,i.jsxs)(e.admonition,{type:"important",children:[(0,i.jsx)(e.p,{children:"In DuckDB, the icu DuckDB extension is needed for time zones support. If the DuckDB client that we are using does not contain the extension, we need to install and load it."}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"INSTALL 'icu'\n"})}),(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"LOAD 'icu'\n"})})]}),"\n",(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)(r.Z,{value:"PRQL DuckDB",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-elm",metastring:"showLineNumbers",children:'let timezone = tz col -> s"timezone({tz}, {col})"\n\nfrom tab\nderive {\n  time_new = (this.time | timezone "UTC" | timezone "US/Eastern")\n}\nselect !{this.time}\ntake 5\n'})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume"}),(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time_new"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28923.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29600.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28624.57"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29331.69"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"54182.93"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2020-12-31 19:00:00"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29331.70"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33300.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28946.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32178.33"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"129993.87"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01 19:00:00"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32176.45"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34778.11"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31962.99"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33000.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"120957.57"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-02 19:00:00"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33000.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33600.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28130.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31988.71"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"140899.89"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-03 19:00:00"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31989.75"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34360.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29900.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33949.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"116050.00"}),(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-04 19:00:00"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"SQL DuckDB",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",metastring:"showLineNumbers",children:"FROM tab\nSELECT\n  * REPLACE timezone('US/Eastern', timezone('UTC', time)) AS time\nLIMIT 5\n"})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2020-12-31 19:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28923.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29600.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28624.57"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29331.69"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"54182.93"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01 19:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29331.70"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33300.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28946.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32178.33"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"129993.87"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-02 19:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32176.45"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34778.11"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31962.99"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33000.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"120957.57"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-03 19:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33000.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33600.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28130.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31988.71"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"140899.89"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-04 19:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31989.75"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34360.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29900.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33949.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"116050.00"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"dplyr R",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-r",metastring:"showLineNumbers",children:'df |>\n  mutate(\n    time = time |>\n      lubridate::force_tz("UTC") |>\n      lubridate::with_tz("US/Eastern")\n  ) |>\n  head(5)\n'})}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{style:{textAlign:"left"},children:"time"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"open"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"high"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"low"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"close"}),(0,i.jsx)(e.th,{style:{textAlign:"right"},children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2020-12-31 19:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28923.63"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29600.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28624.57"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29331.69"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"54182.93"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-01 19:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29331.70"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33300.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28946.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32178.33"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"129993.87"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-02 19:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"32176.45"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34778.11"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31962.99"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33000.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"120957.57"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-03 19:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33000.05"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33600.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"28130.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31988.71"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"140899.89"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{style:{textAlign:"left"},children:"2021-01-04 19:00:00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"31989.75"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"34360.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"29900.00"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"33949.53"}),(0,i.jsx)(e.td,{style:{textAlign:"right"},children:"116050.00"})]})]})]})]}),(0,i.jsxs)(r.Z,{value:"Python Polars",children:[(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'(\n    lf.with_columns(\n        pl.col("time")\n        .cast(pl.Datetime)\n        .dt.replace_time_zone("UTC")\n        .dt.convert_time_zone("US/Eastern")\n    )\n    .head(5)\n    .collect()\n)\n'})}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[14]}}),(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"time"}),(0,i.jsx)(e.th,{children:"open"}),(0,i.jsx)(e.th,{children:"high"}),(0,i.jsx)(e.th,{children:"low"}),(0,i.jsx)(e.th,{children:"close"}),(0,i.jsx)(e.th,{children:"volume"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"datetime[\u03bcs, US/Eastern]"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"}),(0,i.jsx)(e.td,{children:"f64"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2020-12-31 19:00:00 EST"}),(0,i.jsx)(e.td,{children:"28923.63"}),(0,i.jsx)(e.td,{children:"29600.0"}),(0,i.jsx)(e.td,{children:"28624.57"}),(0,i.jsx)(e.td,{children:"29331.69"}),(0,i.jsx)(e.td,{children:"54182.925011"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-01 19:00:00 EST"}),(0,i.jsx)(e.td,{children:"29331.7"}),(0,i.jsx)(e.td,{children:"33300.0"}),(0,i.jsx)(e.td,{children:"28946.53"}),(0,i.jsx)(e.td,{children:"32178.33"}),(0,i.jsx)(e.td,{children:"129993.873362"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-02 19:00:00 EST"}),(0,i.jsx)(e.td,{children:"32176.45"}),(0,i.jsx)(e.td,{children:"34778.11"}),(0,i.jsx)(e.td,{children:"31962.99"}),(0,i.jsx)(e.td,{children:"33000.05"}),(0,i.jsx)(e.td,{children:"120957.56675"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-03 19:00:00 EST"}),(0,i.jsx)(e.td,{children:"33000.05"}),(0,i.jsx)(e.td,{children:"33600.0"}),(0,i.jsx)(e.td,{children:"28130.0"}),(0,i.jsx)(e.td,{children:"31988.71"}),(0,i.jsx)(e.td,{children:"140899.88569"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2021-01-04 19:00:00 EST"}),(0,i.jsx)(e.td,{children:"31989.75"}),(0,i.jsx)(e.td,{children:"34360.0"}),(0,i.jsx)(e.td,{children:"29900.0"}),(0,i.jsx)(e.td,{children:"33949.53"}),(0,i.jsx)(e.td,{children:"116049.997038"})]})]})]}),(0,i.jsx)("div",{dangerouslySetInnerHTML:{__html:j[15]}})]})]}),"\n",(0,i.jsxs)(e.p,{children:["Note that each system may keep time zone information in a different way. Here, the ",(0,i.jsx)(e.code,{children:"time"})," column (and the ",(0,i.jsx)(e.code,{children:"time_new"})," column) in DuckDB results are the TIMESTAMP type, has no time zone information."]}),"\n",(0,i.jsxs)(e.section,{"data-footnotes":!0,className:"footnotes",children:[(0,i.jsx)(e.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{id:"user-content-fn-1",children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.a,{href:"https://duckdb.org/docs/sql/functions/timestamptz#icu-timestamp-with-time-zone-operators",children:"https://duckdb.org/docs/sql/functions/timestamptz#icu-timestamp-with-time-zone-operators"})," ",(0,i.jsx)(e.a,{href:"#user-content-fnref-1","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{id:"user-content-fn-2",children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.a,{href:"https://github.com/tidyverse/lubridate/issues/932",children:"https://github.com/tidyverse/lubridate/issues/932"})," ",(0,i.jsx)(e.a,{href:"#user-content-fnref-2","data-footnote-backref":"","aria-label":"Back to reference 2",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,i.jsxs)(e.li,{id:"user-content-fn-3",children:["\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.a,{href:"https://pola-rs.github.io/polars/py-polars/html/reference/dataframe/api/polars.DataFrame.groupby_dynamic.html",children:"https://pola-rs.github.io/polars/py-polars/html/reference/dataframe/api/polars.DataFrame.groupby_dynamic.html"})," ",(0,i.jsx)(e.a,{href:"#user-content-fnref-3","data-footnote-backref":"","aria-label":"Back to reference 3",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function o(t={}){const{wrapper:e}={...(0,n.a)(),...t.components};return e?(0,i.jsx)(e,{...t,children:(0,i.jsx)(a,{...t})}):a(t)}},5162:(t,e,l)=>{l.d(e,{Z:()=>r});l(7294);var i=l(6905);const n={tabItem:"tabItem_Ymn6"};var s=l(5893);function r(t){let{children:e,hidden:l,className:r}=t;return(0,s.jsx)("div",{role:"tabpanel",className:(0,i.Z)(n.tabItem,r),hidden:l,children:e})}},4866:(t,e,l)=>{l.d(e,{Z:()=>v});var i=l(7294),n=l(6905),s=l(2466),r=l(6550),d=l(469),h=l(1980),x=l(7392),c=l(12);function g(t){return i.Children.toArray(t).filter((t=>"\n"!==t)).map((t=>{if(!t||(0,i.isValidElement)(t)&&function(t){const{props:e}=t;return!!e&&"object"==typeof e&&"value"in e}(t))return t;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof t.type?t.type:t.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function j(t){const{values:e,children:l}=t;return(0,i.useMemo)((()=>{const t=e??function(t){return g(t).map((t=>{let{props:{value:e,label:l,attributes:i,default:n}}=t;return{value:e,label:l,attributes:i,default:n}}))}(l);return function(t){const e=(0,x.l)(t,((t,e)=>t.value===e.value));if(e.length>0)throw new Error(`Docusaurus error: Duplicate values "${e.map((t=>t.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(t),t}),[e,l])}function a(t){let{value:e,tabValues:l}=t;return l.some((t=>t.value===e))}function o(t){let{queryString:e=!1,groupId:l}=t;const n=(0,r.k6)(),s=function(t){let{queryString:e=!1,groupId:l}=t;if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!l)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return l??null}({queryString:e,groupId:l});return[(0,h._X)(s),(0,i.useCallback)((t=>{if(!s)return;const e=new URLSearchParams(n.location.search);e.set(s,t),n.replace({...n.location,search:e.toString()})}),[s,n])]}function y(t){const{defaultValue:e,queryString:l=!1,groupId:n}=t,s=j(t),[r,h]=(0,i.useState)((()=>function(t){let{defaultValue:e,tabValues:l}=t;if(0===l.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!a({value:e,tabValues:l}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${l.map((t=>t.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const i=l.find((t=>t.default))??l[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:e,tabValues:s}))),[x,g]=o({queryString:l,groupId:n}),[y,A]=function(t){let{groupId:e}=t;const l=function(t){return t?`docusaurus.tab.${t}`:null}(e),[n,s]=(0,c.Nk)(l);return[n,(0,i.useCallback)((t=>{l&&s.set(t)}),[l,s])]}({groupId:n}),m=(()=>{const t=x??y;return a({value:t,tabValues:s})?t:null})();(0,d.Z)((()=>{m&&h(m)}),[m]);return{selectedValue:r,selectValue:(0,i.useCallback)((t=>{if(!a({value:t,tabValues:s}))throw new Error(`Can't select invalid tab value=${t}`);h(t),g(t),A(t)}),[g,A,s]),tabValues:s}}var A=l(2389);const m={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var u=l(5893);function f(t){let{className:e,block:l,selectedValue:i,selectValue:r,tabValues:d}=t;const h=[],{blockElementScrollPositionUntilNextRender:x}=(0,s.o5)(),c=t=>{const e=t.currentTarget,l=h.indexOf(e),n=d[l].value;n!==i&&(x(e),r(n))},g=t=>{let e=null;switch(t.key){case"Enter":c(t);break;case"ArrowRight":{const l=h.indexOf(t.currentTarget)+1;e=h[l]??h[0];break}case"ArrowLeft":{const l=h.indexOf(t.currentTarget)-1;e=h[l]??h[h.length-1];break}}e?.focus()};return(0,u.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,n.Z)("tabs",{"tabs--block":l},e),children:d.map((t=>{let{value:e,label:l,attributes:s}=t;return(0,u.jsx)("li",{role:"tab",tabIndex:i===e?0:-1,"aria-selected":i===e,ref:t=>h.push(t),onKeyDown:g,onClick:c,...s,className:(0,n.Z)("tabs__item",m.tabItem,s?.className,{"tabs__item--active":i===e}),children:l??e},e)}))})}function p(t){let{lazy:e,children:l,selectedValue:n}=t;const s=(Array.isArray(l)?l:[l]).filter(Boolean);if(e){const t=s.find((t=>t.props.value===n));return t?(0,i.cloneElement)(t,{className:"margin-top--md"}):null}return(0,u.jsx)("div",{className:"margin-top--md",children:s.map(((t,e)=>(0,i.cloneElement)(t,{key:e,hidden:t.props.value!==n})))})}function b(t){const e=y(t);return(0,u.jsxs)("div",{className:(0,n.Z)("tabs-container",m.tabList),children:[(0,u.jsx)(f,{...t,...e}),(0,u.jsx)(p,{...t,...e})]})}function v(t){const e=(0,A.Z)();return(0,u.jsx)(b,{...t,children:g(t.children)},String(e))}},7741:(t,e,l)=>{l.d(e,{Z:()=>i});const i=l.p+"assets/images/plot-rolling-combined-1-61c1f9be1eee948b0223996b8d917657.png"},2073:(t,e,l)=>{l.d(e,{Z:()=>i});const i=l.p+"assets/images/plot-window-functions-1-2697f18fde4fc52327d5c4cbc7aa44fb.png"},1151:(t,e,l)=>{l.d(e,{Z:()=>d,a:()=>r});var i=l(7294);const n={},s=i.createContext(n);function r(t){const e=i.useContext(s);return i.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function d(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(n):t.components||n:r(t.components),i.createElement(s.Provider,{value:e},t.children)}}}]);